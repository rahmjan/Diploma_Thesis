(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     42107,       1017]
NotebookOptionsPosition[     40628,        991]
NotebookOutlinePosition[     40999,       1007]
CellTagsIndexPosition[     40956,       1004]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "\[OpenCurlyDoubleQuote]Rainbow\[CloseCurlyDoubleQuote] signature scheme is \
part of Multivariate cryptography. In this sheet is a basic example with \
hard-coded values/instance for specific parameters which follows the workflow \
below, where \[OpenCurlyDoubleQuote]w\[CloseCurlyDoubleQuote] is hash of some \
message and \[OpenCurlyDoubleQuote]z\[CloseCurlyDoubleQuote] is its \
signature:\n",
 Cell[BoxData[
  GraphicsBox[
   TagBox[RasterBox[CompressedData["
1:eJztnQd0FFXUxxEjkSoISg9SxUiHAwGkKIZyKCIgRSAQelUPfFQBAZFEkCoi
vVdBCD0B6U16EVA6CCLSawBF78f/fWf2m2xmd2ezQ3az+f/OGdidnXmZmXfn
vttmXt42nzbokDJFihQ9X372T4PwPu/26BHer2HGZ18++qRn546ftG9X65P/
ad+xfY+QNi8+W/nNsyXwhRQpAp79L4QQQgghhBBCCCGEEEIIIYQQQgghhBBC
CCGEEEIIIYT4OVevXpWJEydK8+bNpXr16lKtWjW1NGjQQAYOHCiHDh3y9iES
QhKRv//+W/r27StffPGFREdHS7ly5aRRo0Zy5MgR2bJli4wePVrefvttSZky
pYwcOdLbh0sISSR69+4tX331le17njx5ZNy4cXG2efz4sZQvX17SpEkj//33
X2IfIiHEC+zfv992v9+/f1/wiP7mzZvjbQebIW/evIl8dIQQX2Dfvn1KN9y4
cSPebw0bNpRJkyZ54agIId5m9uzZkjNnznjrZ8yYIcOGDfPCERFCfIFu3bpJ
y5Yt5d9//5WjR48qXYF4xOLFi719aIQQLwF9kCNHDlm6dKm0b99eevXqJT/+
+KM8ffrU24dGiM9w9+5dqVmzpi3H72r54IMP1L2F/b788ktp0aKF/P777zJv
3jz5/PPPpUePHjJlyhRvn5ZTtm/fLhkzZpQnT554+1D8js6dO5uWpRo1asiJ
EydUfBj5ok6dOsmyZcvk2LFjMnbsWOXbdejQQeWep0+frnLMzZo1k4ULF3r7
NJMN9+7dU/b0nDlz5J9//lGfcf3xGXVC27Ztk1atWslHH30k7733norxf/fd
d3L79m1VP1SqVCn5+eefVVtnz56Vl156SfWnr9K9e3dp06aNtw/DL4G+Xb58
ubRt21bJz5o1a6RLly4qN3znzh05cOCADB48WEJCQqRr166yatUqVWu2du1a
mTp1qmTLlk0WLVpkay9fvnzStGlTOXXqlPq+adMmyZUrl7dOL1myYsUKW70P
6gP/+OOPeNvAHkBsH7oBfQRQKzRkyBDbNhs3bpTXXnvNZ2sD4Ddkz55dYmJi
vH0ofgtsytq1a6vP48ePl/nz58fb5uDBg5I2bVqlGzD2YCyBrkCOSAN9hToT
2Awa+FyyZMnnfxJ+Amx8jNvIu+H6Qmdri9lcHPpI0w3wG65fv277DTY47nUs
+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
y+Os//777yVdunRuPXfN/iT2TJs2TYoWLRpvfWRkpCxYsMDhfpQl73Pjxg3Z
uXNnvPVNmjSRmjVrutUW+5PY061bNwkMDLQ9J2EWypJvArsvW7ZsEhER4dZ+
7E9iz5EjRyRTpkySIUMG9TwVxiIzUJZ8k19//VXFGhBjcAf2JzHi5s2b0r9/
f5V7gJ+Kz658VcqSb4JYQ5o0aVTsyB3Yn0SPvY1w+/Zt9bw1xp1+/fo53Zey
5Jsg1hAaGur2fuxPAmAThIWFyYoVK+L9Bn8VufDy5cs7bYOy5HugNiVr1qyq
1sFd2J8EIF8J2+DOnTuGv3/44YfKr3AGZcn32LZtmwQEBMi1a9fc3pf9ScDa
tWuVbggPD5dHjx7F+S06OlqaNWvm8j2QlCXfA+/xrFOnToL2xbv+CIHfMGDA
APU+WNigjRs3llatWknLli1l8uTJpmpmYFsQ3wE1bMHBwbJnz54E7U9dT/TA
9ly/fr3ExMTI+fPnlb9qFsqSb4G+czc3oYf9SayCsuRfsD+JVVCW/Av2J7EK
ypJ/wf4kVkFZ8i/Yn8QqKEv+BfuTWAVlKWmD3JQ+V63vT+Q8UANDSEKgbkja
LFmyRBo2bKjmNgVaf/7000/qmYypU6d68/BIEoa6IemDeohBgwapOji8G3jc
uHFqXlP7WllC3IG6wX8YM2aMqqHH+zsI8RTqBv8BNfSjRo1S758kxFP4bA4h
hBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIb4P6sjxrGqjRo2kSpUqhsu7776r
5mu4e/eutw+XEJJI7Nu3T+bOnSsnTpxQ8w+XLl1aunTpoj5jOXbsmMycOVN6
9uxpas4GQoj/gXsf88xv3brV24dCCPEhNm/eLJkyZaJ9QAiJA+aWb968ubcP
gxDiQyAm+cYbb0ixYsXUO/S0ZdasWd4+NEKIF0GMIVu2bLJp0yblW2BZuXKl
PHz40NuHRohP0LlzZ6lWrZqppUaNGiq+7w/Uq1dPIiMjvX0YfsGkSZNMyxCW
H374wduHTEyAebqXL18ubdu2VTG5NWvWqJze48eP5c6dO3LgwAEZPHiwhISE
SNeuXWXVqlXKHsf7aTt16qTmZN65c6f06dNHhg4dqt5Z6+vvoDt58qRkzJhR
nR/xHMxtcObMGSlTpoySIdSF4PO9e/ckNjZWjSd4v3mJEiUkIiJC5Yf1MrRs
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
     "], {{0, 140}, {263, 0}}, {0, 255},
     ColorFunction->RGBColor],
    BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
    Selectable->False],
   DefaultBaseStyle->"ImageGraphics",
   ImageSizeRaw->{263, 140},
   PlotRange->{{0, 263}, {0, 140}}]], "Input",ExpressionUUID->
  "258428e8-952b-4e7e-91af-0c74f06dfde0"],
 "\nExample is composed of four parts:\n1) Setting up of values and \
parameters for the example:  Finite field \[OpenCurlyDoubleQuote]\
\[DoubleStruckCapitalF] = GF(7)\[CloseCurlyDoubleQuote], number of oil \
variables ",
 Cell[BoxData[
  FormBox["\"\<\!\(
\*SubscriptBox[\(o\), \(1\)]\)\>", TraditionalForm]],ExpressionUUID->
  "eb1d2702-8ad0-462c-a075-be632cdd7116"],
 " = 2\[CloseCurlyDoubleQuote] and \[OpenCurlyDoubleQuote]",
 Cell[BoxData[
  FormBox[
   SubscriptBox["o", "2"], TraditionalForm]],ExpressionUUID->
  "0d88b2d5-2b4c-4db3-837e-07bd690694a3"],
 " = 2\[CloseCurlyDoubleQuote], number of vinegar variables \
\[OpenCurlyDoubleQuote]v = 2\[CloseCurlyDoubleQuote]. From these parameters \
were generated central map  \[ScriptCapitalF] (F3,F4,F5,F6), affine map  \
\[ScriptCapitalT] (matrix T) and affine map \[ScriptCapitalS] (matrix S), \
\[OpenCurlyDoubleQuote]n = v + ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["o", "1"], TraditionalForm]],ExpressionUUID->
  "76058ec5-d1e1-4722-b7de-5ec1dfa94ea2"],
 "+ ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["o", "2"], TraditionalForm]],ExpressionUUID->
  "eece89f6-3248-46ff-bf6b-1cda369885ae"],
 "\[CloseCurlyDoubleQuote].\n\t ",
 StyleBox["Private key",
  FontWeight->"Bold"],
 " is a triplet of  \[ScriptCapitalS],  \[ScriptCapitalF] and  \
\[ScriptCapitalT].\n2) Computation of ",
 StyleBox["public key",
  FontWeight->"Bold"],
 " \[ScriptCapitalP] by composition of  \[ScriptCapitalS],  \[ScriptCapitalF] \
and  \[ScriptCapitalT]:  \[OpenCurlyDoubleQuote]\[ScriptCapitalP] = \
\[ScriptCapitalS] o \[ScriptCapitalF] o \[ScriptCapitalT]\
\[CloseCurlyDoubleQuote]. When applied to the signature, we will get the \
hash: \[OpenCurlyDoubleQuote]w = \
\[ScriptCapitalP](z)\[CloseCurlyDoubleQuote].\n3) Computation of signature \
\[OpenCurlyDoubleQuote]z\[CloseCurlyDoubleQuote] from hash \
\[OpenCurlyDoubleQuote]w\[CloseCurlyDoubleQuote] in three steps:\n\t1] Get \
\[OpenCurlyDoubleQuote]x\[CloseCurlyDoubleQuote]: \[OpenCurlyDoubleQuote]x = ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ScriptCapitalS]", 
    RowBox[{"-", "1"}]], TraditionalForm]],ExpressionUUID->
  "8971ddbb-4379-481b-b970-1ece2e0a581a"],
 "(w)\[CloseCurlyDoubleQuote]\n\t2] Get pre-image \[OpenCurlyDoubleQuote]y\
\[CloseCurlyDoubleQuote] of \[OpenCurlyDoubleQuote]x\[CloseCurlyDoubleQuote]: \
\[OpenCurlyDoubleQuote]y = ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ScriptCapitalF]", 
    RowBox[{"-", "1"}]], TraditionalForm]],ExpressionUUID->
  "b1789d25-3000-4db3-ae3e-4f94cba8579b"],
 "(x)\[CloseCurlyDoubleQuote], in this step the pre-image is computed part by \
part from \[OpenCurlyDoubleQuote]",
 Cell[BoxData[
  FormBox[
   SubscriptBox["o", "i"], TraditionalForm]],ExpressionUUID->
  "5bc8d466-f38b-490b-8c87-e3486c6e7206"],
 "\[CloseCurlyDoubleQuote] and that is the main difference from UOV. In this \
example there are two \[OpenCurlyDoubleQuote]o\[CloseCurlyDoubleQuote] then \
in two steps (layers) is computed the pre-image.\n\t3] Get signature \
\[OpenCurlyDoubleQuote]z\[CloseCurlyDoubleQuote]: \[OpenCurlyDoubleQuote]z = ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ScriptCapitalT]", 
    RowBox[{"-", "1"}]], TraditionalForm]],ExpressionUUID->
  "5287dd09-5763-4f46-8b2a-6ee70a53a05a"],
 "(y)\[CloseCurlyDoubleQuote]\n4) Check if hash \[OpenCurlyDoubleQuote]w\
\[CloseCurlyDoubleQuote] is is equal to  \[ScriptCapitalP](z):\n\t\
\[OpenCurlyDoubleQuote]w == \[ScriptCapitalP](z)\[CloseCurlyDoubleQuote] \n\t\
\t\t=> It should be true because: \[OpenCurlyDoubleQuote]z = ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ScriptCapitalT]", 
    RowBox[{"-", "1"}]], TraditionalForm]],ExpressionUUID->
  "b2b7ee4f-7638-40e9-9161-bc38fe37ce2c"],
 "(",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ScriptCapitalF]", 
    RowBox[{"-", "1"}]], TraditionalForm]],ExpressionUUID->
  "b89f585d-9e75-4b44-9903-1b2eb9353c3e"],
 "(",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ScriptCapitalS]", 
    RowBox[{"-", "1"}]], TraditionalForm]],ExpressionUUID->
  "6af9be8b-e7a1-4fd3-b079-feae4e1e4a39"],
 "(w)))\[CloseCurlyDoubleQuote] and \
\[OpenCurlyDoubleQuote]\[ScriptCapitalP](z) = \[ScriptCapitalS](\
\[ScriptCapitalF](\[ScriptCapitalT](z)))\[CloseCurlyDoubleQuote], so: \n\t\t\t\
\[OpenCurlyDoubleQuote]\[ScriptCapitalP](z) = \[ScriptCapitalS](\
\[ScriptCapitalF]( \[ScriptCapitalT](",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ScriptCapitalT]", 
    RowBox[{"-", "1"}]], TraditionalForm]],ExpressionUUID->
  "2efe8b14-fc74-4fe9-94c8-6de30101bf1a"],
 "(",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ScriptCapitalF]", 
    RowBox[{"-", "1"}]], TraditionalForm]],ExpressionUUID->
  "0d0b50ab-beed-4796-80e6-67c05759008b"],
 "(",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ScriptCapitalS]", 
    RowBox[{"-", "1"}]], TraditionalForm]],ExpressionUUID->
  "dbb93bd3-d95f-4152-a329-49974fb00403"],
 "(w)))))) = S(\[ScriptCapitalF](",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ScriptCapitalF]", 
    RowBox[{"-", "1"}]], TraditionalForm]],ExpressionUUID->
  "1e80cdfc-7954-4092-b42a-465199eb5e2c"],
 "(",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ScriptCapitalS]", 
    RowBox[{"-", "1"}]], TraditionalForm]],ExpressionUUID->
  "0132430a-93a1-46f5-be73-014191fff6cb"],
 "(w)))) = \[ScriptCapitalS](",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ScriptCapitalS]", 
    RowBox[{"-", "1"}]], TraditionalForm]],ExpressionUUID->
  "372716c9-2659-483f-becf-79f46a2f89c6"],
 "(w)) = w\[CloseCurlyDoubleQuote].\n"
}], "Text",
 CellChangeTimes->{{3.7975015223507795`*^9, 3.7975015411363325`*^9}, {
  3.7975018031787643`*^9, 3.7975018851384754`*^9}, {3.7975019193568563`*^9, 
  3.797502256502384*^9}, {3.7975023018278646`*^9, 3.797502319687291*^9}, {
  3.797502403254448*^9, 3.797502606107917*^9}, {3.7975026455316114`*^9, 
  3.797502652575025*^9}, {3.7975027364413223`*^9, 3.7975027383944106`*^9}, {
  3.797503213089959*^9, 3.797503213411642*^9}, {3.797666233879017*^9, 
  3.7976662930562363`*^9}, {3.7976663275461197`*^9, 3.7976665613812885`*^9}, {
  3.797666626005035*^9, 3.7976666280567446`*^9}, {3.7976666971045904`*^9, 
  3.797666741621546*^9}, {3.79766678386596*^9, 3.79766678386596*^9}, {
  3.7987937653979464`*^9, 3.7987937851438274`*^9}, {3.798794434752162*^9, 
  3.7987944380177484`*^9}},ExpressionUUID->"df10ed9f-b056-41f1-9bc5-\
ba19d50e8221"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", " ", "\[DoubleStruckCapitalF]"}], "=", 
    RowBox[{
     RowBox[{"GF", 
      RowBox[{"(", "7", ")"}], " ", "and", " ", 
      RowBox[{"(", 
       RowBox[{"v1", ",", "o1", ",", "o2"}], ")"}]}], "=", 
     RowBox[{"(", 
      RowBox[{"2", ",", "2", ",", "2"}], ")"}]}]}], " ", 
   "***)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mod", " ", "=", " ", "7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"F3", "[", 
    RowBox[{
    "x1_", ",", "x2_", ",", "x3_", ",", "x4_", ",", "x5_", ",", "x6_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"x1", "^", "2"}], "+", 
    RowBox[{"3", "x1", "*", "x2"}], "+", 
    RowBox[{"5", "x1", "*", "x3"}], "+", 
    RowBox[{"6", "x1", "*", "x4"}], "+", 
    RowBox[{"2", 
     RowBox[{"x2", "^", "2"}]}], "+", 
    RowBox[{"6", "x2", "*", "x3"}], "+", 
    RowBox[{"4", "x2", "*", "x4"}], "+", 
    RowBox[{"2", "x2"}], "+", 
    RowBox[{"6", "x3"}], "+", 
    RowBox[{"2", "x4"}], "+", "5"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"F4", "[", 
    RowBox[{
    "x1_", ",", "x2_", ",", "x3_", ",", "x4_", ",", "x5_", ",", "x6_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"2", 
     RowBox[{"x1", "^", "2"}]}], "+", 
    RowBox[{"x1", "*", "x2"}], "+", 
    RowBox[{"x1", "*", "x3"}], "+", 
    RowBox[{"3", "x1", "*", "x4"}], "+", 
    RowBox[{"4", "x1"}], "+", 
    RowBox[{"x2", "^", "2"}], "+", 
    RowBox[{"x2", "*", "x3"}], "+", 
    RowBox[{"4", "x2", "*", "x4"}], "+", 
    RowBox[{"6", "x2"}], "+", "x4"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"F5", "[", 
    RowBox[{
    "x1_", ",", "x2_", ",", "x3_", ",", "x4_", ",", "x5_", ",", "x6_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"2", 
     RowBox[{"x1", "^", "2"}]}], "+", 
    RowBox[{"3", "x1", "*", "x2"}], "+", 
    RowBox[{"3", "x1", "*", "x3"}], "+", 
    RowBox[{"3", "x1", "*", "x4"}], "+", 
    RowBox[{"x1", "*", "x5"}], "+", 
    RowBox[{"3", "x1", "*", "x6"}], "+", 
    RowBox[{"6", "x1"}], "+", 
    RowBox[{"4", 
     RowBox[{"x2", "^", "2"}]}], "+", 
    RowBox[{"x2", "*", "x3"}], "+", 
    RowBox[{"4", "x2", "*", "x4"}], "+", 
    RowBox[{"x2", "*", "x5"}], "+", 
    RowBox[{"3", "x2", "*", "x6"}], "+", 
    RowBox[{"3", "x2"}], "+", 
    RowBox[{"3", "x3", "*", "x4"}], "+", 
    RowBox[{"x3", "*", "x5"}], "+", 
    RowBox[{"2", "x3", "*", "x6"}], "+", 
    RowBox[{"2", "x3"}], "+", 
    RowBox[{"3", "x4", "*", "x5"}], "+", "x5", "+", 
    RowBox[{"6", "x6"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"F6", "[", 
     RowBox[{
     "x1_", ",", "x2_", ",", "x3_", ",", "x4_", ",", "x5_", ",", "x6_"}], 
     "]"}], ":=", 
    RowBox[{
     RowBox[{"2", 
      RowBox[{"x1", "^", "2"}]}], "+", 
     RowBox[{"5", "x1", "*", "x2"}], "+", 
     RowBox[{"x1", "*", "x3"}], "+", 
     RowBox[{"5", "x1", "*", "x4"}], "+", 
     RowBox[{"5", "x1", "*", "x6"}], "+", 
     RowBox[{"6", "x1"}], "+", 
     RowBox[{"5", 
      RowBox[{"x2", "^", "2"}]}], "+", 
     RowBox[{"3", "x2", "*", "x3"}], "+", 
     RowBox[{"5", "x2", "*", "x5"}], "+", 
     RowBox[{"4", "x2", "*", "x6"}], "+", "x2", "+", 
     RowBox[{"3", 
      RowBox[{"x3", "^", "2"}]}], "+", 
     RowBox[{"5", "x3", "*", "x4"}], "+", 
     RowBox[{"4", "x3", "*", "x5"}], "+", 
     RowBox[{"2", "x3", "*", "x6"}], "+", 
     RowBox[{"4", "x3"}], "+", 
     RowBox[{"x4", "^", "2"}], "+", 
     RowBox[{"6", "x4", "*", "x5"}], "+", 
     RowBox[{"3", "x4", "*", "x6"}], "+", 
     RowBox[{"4", "x4"}], "+", 
     RowBox[{"4", "x5"}], "+", "x6", "+", "2"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "In", " ", "the", " ", "\[ScriptCapitalF]", " ", "only", " ", "the", " ", 
     "vinegar", " ", "variables", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"in", " ", "the", " ", "first", " ", 
        RowBox[{"layer", ":", " ", "x1"}]}], ",", 
       RowBox[{"x2", " ", "and", " ", "in", " ", "the", " ", "second", " ", 
        RowBox[{"layer", ":", " ", "x1"}]}], ",", "x2", ",", "x3", ",", 
       "x4"}], ")"}], " ", "can", " ", "be", " ", "quadratic", " ", "because",
      " ", "in", " ", "the", " ", "computation", " ", "of", " ", "the", " ", 
     "pre"}], "-", 
    RowBox[{
    "image", " ", "we", " ", "substitute", " ", "them", " ", "with", " ", 
     "concrete", " ", "value", " ", "and", " ", "we", " ", "get", " ", 
     "linear", " ", "equations"}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"(", GridBox[{
      {"6", "5", "5", "5", "5", "4"},
      {"6", "6", "4", "5", "0", "6"},
      {"2", "5", "2", "1", "5", "0"},
      {"1", "1", "6", "2", "2", "3"},
      {"3", "6", "2", "2", "3", "0"},
      {"0", "5", "4", "6", "1", "5"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"(", GridBox[{
      {"1"},
      {"2"},
      {"4"},
      {"1"},
      {"3"},
      {"2"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T", "=", 
   RowBox[{
    RowBox[{"A", ".", 
     RowBox[{"(", GridBox[{
        {"x1"},
        {"x2"},
        {"x3"},
        {"x4"},
        {"x5"},
        {"x6"}
       }], ")"}]}], "+", "b"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A2", "=", 
   RowBox[{"(", GridBox[{
      {"6", "5", "5", "5"},
      {"6", "6", "4", "5"},
      {"2", "5", "2", "1"},
      {"1", "1", "6", "2"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b2", "=", 
   RowBox[{"(", GridBox[{
      {"1"},
      {"2"},
      {"4"},
      {"1"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S", "=", 
   RowBox[{
    RowBox[{"A2", ".", 
     RowBox[{"(", GridBox[{
        {"x1"},
        {"x2"},
        {"x3"},
        {"x4"}
       }], ")"}]}], "+", "b2"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7894663409951344`*^9, 3.7894665908031225`*^9}, {
   3.789466637505204*^9, 3.7894666424809*^9}, {3.7894667081842327`*^9, 
   3.789466712240348*^9}, {3.7894669165948606`*^9, 3.789466972295905*^9}, {
   3.79232148430294*^9, 3.7923215074341784`*^9}, {3.7923215540471745`*^9, 
   3.7923215647803335`*^9}, {3.792321615021569*^9, 3.792321615338709*^9}, {
   3.792323779220538*^9, 3.792323779813981*^9}, {3.792324259028693*^9, 
   3.792324270567184*^9}, 3.792324374970822*^9, {3.792324541078044*^9, 
   3.7923245824546423`*^9}, {3.7923246278692245`*^9, 3.7923246664509277`*^9}, 
   3.792324759312191*^9, 3.7923256007850447`*^9, {3.792326004953437*^9, 
   3.792326018662506*^9}, 3.7923423593870163`*^9, 3.797435801086034*^9, {
   3.7975015649627147`*^9, 3.7975015863055377`*^9}, 3.7976662685623035`*^9, {
   3.7983536096088266`*^9, 3.798353610014936*^9}, {3.7983537101962976`*^9, 
   3.7983537430028725`*^9}, {3.7983538401009355`*^9, 3.798353845800397*^9}, {
   3.798363090389226*^9, 3.798363090567749*^9}, {3.7988058835783195`*^9, 
   3.7988058840008745`*^9}},ExpressionUUID->"b4b7858b-fbc4-4973-b765-\
1f0c8ce5b755"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "Compute", " ", "public", " ", "key", " ", 
    "\"\<\[ScriptCapitalP] = \[ScriptCapitalS] o \[ScriptCapitalF] o \
\[ScriptCapitalT]\>\""}], " ", "**)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"p3", " ", "=", " ", 
     RowBox[{"F3", " ", "@@", " ", 
      RowBox[{"T", "[", 
       RowBox[{"[", "All", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p4", " ", "=", " ", 
     RowBox[{"F4", " ", "@@", " ", 
      RowBox[{"T", "[", 
       RowBox[{"[", "All", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p5", " ", "=", " ", 
     RowBox[{"F5", " ", "@@", " ", 
      RowBox[{"T", "[", 
       RowBox[{"[", "All", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p6", " ", "=", " ", 
     RowBox[{"F6", " ", "@@", " ", 
      RowBox[{"T", "[", 
       RowBox[{"[", "All", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"S3", "[", 
      RowBox[{"x1_", ",", "x2_", ",", "x3_", ",", "x4_"}], "]"}], "=", 
     RowBox[{"S", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"S4", "[", 
      RowBox[{"x1_", ",", "x2_", ",", "x3_", ",", "x4_"}], "]"}], "=", 
     RowBox[{"S", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"S5", "[", 
      RowBox[{"x1_", ",", "x2_", ",", "x3_", ",", "x4_"}], "]"}], "=", 
     RowBox[{"S", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"S6", "[", 
      RowBox[{"x1_", ",", "x2_", ",", "x3_", ",", "x4_"}], "]"}], "=", 
     RowBox[{"S", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pp3", " ", "=", " ", 
     RowBox[{
      RowBox[{"S3", "[", 
       RowBox[{"p3", ",", "p4", ",", "p5", ",", "p6"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pp4", " ", "=", " ", 
     RowBox[{
      RowBox[{"S4", "[", 
       RowBox[{"p3", ",", "p4", ",", "p5", ",", "p6"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pp5", " ", "=", " ", 
     RowBox[{
      RowBox[{"S5", "[", 
       RowBox[{"p3", ",", "p4", ",", "p5", ",", "p6"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pp6", " ", "=", " ", 
     RowBox[{
      RowBox[{"S6", "[", 
       RowBox[{"p3", ",", "p4", ",", "p5", ",", "p6"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P3", "[", 
      RowBox[{
      "x1_", ",", "x2_", ",", "x3_", ",", "x4_", ",", "x5_", ",", "x6_"}], 
      "]"}], "=", 
     RowBox[{"PolynomialMod", "[", 
      RowBox[{
       RowBox[{"Simplify", "[", "pp3", "]"}], ",", "mod"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P4", "[", 
      RowBox[{
      "x1_", ",", "x2_", ",", "x3_", ",", "x4_", ",", "x5_", ",", "x6_"}], 
      "]"}], "=", 
     RowBox[{"PolynomialMod", "[", 
      RowBox[{
       RowBox[{"Simplify", "[", "pp4", "]"}], ",", "mod"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P5", "[", 
      RowBox[{
      "x1_", ",", "x2_", ",", "x3_", ",", "x4_", ",", "x5_", ",", "x6_"}], 
      "]"}], "=", 
     RowBox[{"PolynomialMod", "[", 
      RowBox[{
       RowBox[{"Simplify", "[", "pp5", "]"}], ",", "mod"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P6", "[", 
      RowBox[{
      "x1_", ",", "x2_", ",", "x3_", ",", "x4_", ",", "x5_", ",", "x6_"}], 
      "]"}], "=", 
     RowBox[{"PolynomialMod", "[", 
      RowBox[{
       RowBox[{"Simplify", "[", "pp6", "]"}], ",", "mod"}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.792323832906965*^9, 3.7923240590668726`*^9}, {
   3.792324102786028*^9, 3.7923241032005653`*^9}, {3.7923241611487756`*^9, 
   3.7923242096861467`*^9}, 3.7923243449713836`*^9, 3.7923247371399097`*^9, {
   3.792324829380071*^9, 3.792324829676278*^9}, {3.7923248936699657`*^9, 
   3.792324968783388*^9}, {3.792325001744011*^9, 3.7923250021110687`*^9}, {
   3.7923251111899586`*^9, 3.792325162545866*^9}, {3.7923251949452486`*^9, 
   3.7923252422287035`*^9}, {3.7923252766721888`*^9, 3.792325311687008*^9}, {
   3.7923253516057577`*^9, 3.7923254282228584`*^9}, {3.792325460356701*^9, 
   3.7923254643689384`*^9}, {3.7923255059478645`*^9, 
   3.7923255809768515`*^9}, {3.7923256688477592`*^9, 3.792325669967539*^9}, {
   3.792325765082012*^9, 3.7923259342820053`*^9}, 3.7923260410681715`*^9, {
   3.7923420948930683`*^9, 3.792342116805479*^9}, {3.7923433112791348`*^9, 
   3.792343371594827*^9}, {3.792343420395893*^9, 3.7923437188556166`*^9}, {
   3.7923437537405577`*^9, 3.7923438198405285`*^9}, {3.7923439932003083`*^9, 
   3.792344007138333*^9}, {3.7923440582690544`*^9, 3.7923440890322556`*^9}, {
   3.7923442388917847`*^9, 3.7923442588497066`*^9}, {3.7976665429343033`*^9, 
   3.79766654539771*^9}},
 CellLabel->
  "In[1016]:=",ExpressionUUID->"74fbdeb8-436c-4c96-b6ba-83a14910a94c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Hash", " ", "\"\<w\>\""}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"w", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "2", "}"}], ",", 
      RowBox[{"{", "2", "}"}], ",", 
      RowBox[{"{", "3", "}"}], ",", 
      RowBox[{"{", "4", "}"}]}], "}"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.79234224496301*^9, 3.7923422623253307`*^9}, {
   3.792342340998441*^9, 3.792342353549997*^9}, {3.792342401930235*^9, 
   3.792342505059268*^9}, {3.792342551518744*^9, 3.792342588975992*^9}, {
   3.7923426278971796`*^9, 3.792342695407936*^9}, {3.792342727861856*^9, 
   3.792342746801897*^9}, {3.7933678119688807`*^9, 3.7933678150371647`*^9}, {
   3.7974321272040825`*^9, 3.797432127621966*^9}, {3.7975016827919703`*^9, 
   3.7975016996845617`*^9}, 3.7976665761981554`*^9, {3.798806400722561*^9, 
   3.7988064632550526`*^9}},ExpressionUUID->"045dfbba-fe0f-4098-929c-\
730016040cb2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "*", " ", "Compute", " ", "\"\<x\>\"", " ", "from", " ", "hash", " ", 
     "\"\<w\>\""}], ":", " ", 
    "\"\<x = \!\(\*SuperscriptBox[\(\[ScriptCapitalS]\), \(-1\)]\)(w)\>\""}], 
   " ", "**)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["A2", 
      RowBox[{"-", "1"}]], "=", 
     RowBox[{"Inverse", "[", 
      RowBox[{"A2", ",", " ", 
       RowBox[{"Modulus", "\[Rule]", "mod"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"x", " ", "=", " ", 
    RowBox[{"Mod", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["A2", 
        RowBox[{"-", "1"}]], ".", 
       RowBox[{"(", 
        RowBox[{"w", "-", "b2"}], ")"}]}], ",", "mod"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.798806464615385*^9, 
  3.798806473605192*^9}},ExpressionUUID->"1f1d763f-1413-402e-9377-\
8a33c104e646"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"*", " ", "Compute", " ", "pre"}], "-", 
    RowBox[{"image", " ", "\"\<y\>\"", " ", "of", " ", "\"\<x\>\""}]}], " ", 
   "**)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"y1", "=", " ", "0"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Values", " ", "for", " ", "\"\<y\>\"", "s", " ", "are", " ", "randomly", 
     " ", "selected"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"y2", "=", " ", "1"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7889687820181227`*^9, 3.788968827293056*^9}, {
   3.7889691114581127`*^9, 3.78896913441076*^9}, {3.7894806258709326`*^9, 
   3.7894806263476562`*^9}, 3.7894806833781195`*^9, {3.7894808365789967`*^9, 
   3.7894808372092977`*^9}, {3.789808780222294*^9, 3.789808819719979*^9}, {
   3.789810319168583*^9, 3.7898103543858976`*^9}, {3.7898104305440364`*^9, 
   3.7898104390397425`*^9}, 3.789810473793621*^9, {3.789810722903133*^9, 
   3.789810723808831*^9}, 3.789818392061214*^9, {3.789821105860922*^9, 
   3.7898211124991693`*^9}, {3.792321587893344*^9, 3.792321603798177*^9}, {
   3.792321684052455*^9, 3.7923216949115067`*^9}, {3.792321767348324*^9, 
   3.79232177278679*^9}, {3.7923218579061103`*^9, 3.79232186082825*^9}, {
   3.792321995786848*^9, 3.7923220199877434`*^9}, {3.792322179963703*^9, 
   3.7923221801721025`*^9}, {3.792322307484179*^9, 3.79232230879115*^9}, {
   3.792342509567892*^9, 3.7923425098740435`*^9}},
 CellLabel->
  "In[1035]:=",ExpressionUUID->"984a135c-ac22-480a-86bc-e8d76a01d8c9"],

Cell[BoxData[{
 RowBox[{"f3", " ", "=", " ", 
  RowBox[{"PolynomialMod", "[", 
   RowBox[{
    RowBox[{"F3", "[", 
     RowBox[{"y1", ",", "y2", ",", "x3", ",", "x4", ",", "x5", ",", "x6"}], 
     "]"}], ",", "mod"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"f4", " ", "=", " ", 
  RowBox[{"PolynomialMod", "[", 
   RowBox[{
    RowBox[{"F4", "[", 
     RowBox[{"y1", ",", "y2", ",", "x3", ",", "x4", ",", "x5", ",", "x6"}], 
     "]"}], ",", "mod"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"f5", " ", "=", " ", 
  RowBox[{"PolynomialMod", "[", 
   RowBox[{
    RowBox[{"F5", "[", 
     RowBox[{"y1", ",", "y2", ",", "x3", ",", "x4", ",", "x5", ",", "x6"}], 
     "]"}], ",", "mod"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"f6", " ", "=", " ", 
  RowBox[{"PolynomialMod", "[", 
   RowBox[{
    RowBox[{"F6", "[", 
     RowBox[{"y1", ",", "y2", ",", "x3", ",", "x4", ",", "x5", ",", "x6"}], 
     "]"}], ",", "mod"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.79232164829782*^9, 3.7923216495859365`*^9}, {
   3.7923222946856813`*^9, 3.7923223735599966`*^9}, {3.7923428535259943`*^9, 
   3.7923428569296823`*^9}, 3.7974321464714985`*^9, {3.798353928338612*^9, 
   3.79835392945794*^9}},
 CellLabel->
  "In[1037]:=",ExpressionUUID->"076d4c63-501e-464f-a4ef-2162a62358ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Solve", " ", 
     RowBox[{"(", 
      RowBox[{"first", " ", "layer"}], ")"}]}], " ", "//", 
    RowBox[{
    "We", " ", "can", " ", "also", " ", "use", " ", "Gaussian", " ", 
     "elimination"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"res1", " ", "=", " ", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"f3", "\[Equal]", 
          RowBox[{"x", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
         RowBox[{"f4", "\[Equal]", 
          RowBox[{"x", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"Modulus", " ", "\[Rule]", " ", "mod"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"If", " ", "solution", " ", "not", " ", "possible"}], " ", 
     "\[Rule]", " ", 
     RowBox[{
     "Select", " ", "different", " ", "values", " ", "for", " ", "\"\<y\>\"", 
      "s"}]}], " ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.79232246735715*^9, 3.7923225488659945`*^9}, 
   3.792322831653624*^9, {3.792342939842164*^9, 3.792342943344557*^9}, {
   3.797856125948642*^9, 3.7978561261123247`*^9}, {3.7978572703716354`*^9, 
   3.7978572740119085`*^9}},
 CellLabel->
  "In[1041]:=",ExpressionUUID->"da7355a4-f739-4489-9771-a23eae823033"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Substitue", " ", "F5", " ", "and", " ", "F6"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"f5", " ", "=", " ", 
     RowBox[{"PolynomialMod", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"F5", "[", 
         RowBox[{
         "y1", ",", "y2", ",", "x3", ",", "x4", ",", "x5", ",", "x6"}], "]"}],
         "/.", " ", "res1"}], " ", ",", "mod"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"f6", " ", "=", " ", 
     RowBox[{"PolynomialMod", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"F6", "[", 
         RowBox[{
         "y1", ",", "y2", ",", "x3", ",", "x4", ",", "x5", ",", "x6"}], "]"}],
         "/.", " ", "res1"}], " ", ",", "mod"}], "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7923226421403613`*^9, 3.7923226458590117`*^9}, {
  3.7923226926823463`*^9, 3.792322704769269*^9}, {3.792322735150084*^9, 
  3.7923227924008346`*^9}, {3.7923228361914167`*^9, 3.7923228402986774`*^9}, {
  3.7923429344140263`*^9, 3.7923429646570625`*^9}},
 CellLabel->
  "In[1042]:=",ExpressionUUID->"2f3e0565-f4a5-487e-bb37-5fe2c5f6205a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Solve", " ", 
     RowBox[{"(", 
      RowBox[{"second", " ", "layer"}], ")"}]}], " ", "//", 
    RowBox[{
    "We", " ", "can", " ", "also", " ", "use", " ", "Gaussian", " ", 
     "Elimination"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"res2", " ", "=", " ", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"f5", "\[Equal]", 
          RowBox[{"x", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ",", " ", 
         RowBox[{"f6", "\[Equal]", 
          RowBox[{"x", "[", 
           RowBox[{"[", "4", "]"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"Modulus", " ", "\[Rule]", " ", "mod"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"If", " ", "solution", " ", "not", " ", "possible"}], " ", 
     "\[Rule]", " ", 
     RowBox[{
     "Select", " ", "different", " ", "values", " ", "for", " ", "\"\<y\>\"", 
      "s"}]}], " ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.79232246735715*^9, 3.7923225488659945`*^9}, {
  3.792322608230344*^9, 3.7923226248645*^9}, {3.7923228224034863`*^9, 
  3.7923228520868177`*^9}, {3.792342995819521*^9, 3.792343000852747*^9}, {
  3.7978572533023148`*^9, 3.7978572543076963`*^9}, {3.7978572866153097`*^9, 
  3.7978572905091352`*^9}},
 CellLabel->
  "In[1044]:=",ExpressionUUID->"da5400f8-0310-47ab-af20-65e4dd3f4c6e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Pre", "-", 
     RowBox[{"image", " ", "of", " ", "\"\<x\>\""}]}], ":", " ", 
    "\"\<y = \!\(\*SuperscriptBox[\(\[ScriptCapitalF]\), \(-1\)]\)(x)\>\""}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"y", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "y1", ",", "y2", ",", "x3", ",", " ", "x4", ",", "x5", ",", "x6"}], 
       "}"}], "/.", "res1"}], "/.", "res2"}]}], ";", 
   RowBox[{"y", " ", "=", " ", 
    RowBox[{"y", "[", 
     RowBox[{"[", "1", "]"}], "]"}], 
    RowBox[{"(*", " ", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "4", ",", "2", ",", "0", ",", "2"}], "}"}],
       "}"}], " ", "*)"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7889721540887775`*^9, 3.788972159780518*^9}, {
  3.7889722203565254`*^9, 3.7889722349185867`*^9}, {3.788972278855115*^9, 
  3.788972320468804*^9}, {3.7889724296049995`*^9, 3.7889724324503736`*^9}, {
  3.7889724960433197`*^9, 3.7889725127596073`*^9}, {3.7894806311029406`*^9, 
  3.7894806315587215`*^9}, {3.7894806661392198`*^9, 3.7894806751381874`*^9}, {
  3.7894808250598073`*^9, 3.7894808279700146`*^9}, {3.78981069708341*^9, 
  3.7898107007161865`*^9}, {3.7898213896308823`*^9, 3.789821394402094*^9}, {
  3.7923228765311456`*^9, 3.7923229002516623`*^9}, {3.792322932108284*^9, 
  3.7923230857669125`*^9}, {3.792323303637032*^9, 3.792323405660941*^9}, {
  3.792323438583296*^9, 3.792323487643545*^9}, {3.792343017404318*^9, 
  3.792343020069021*^9}, {3.797501629869378*^9, 3.7975016355696535`*^9}, {
  3.7976665886769147`*^9, 3.7976665888920603`*^9}},
 CellLabel->
  "In[1045]:=",ExpressionUUID->"0328917d-e1ad-4b1e-ad9f-c846ea635503"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "Compute", " ", "signature", " ", 
    "\"\<z = \!\(\*SuperscriptBox[\(\[ScriptCapitalT]\), \(-1\)]\)(y)\>\""}], 
   " ", "**)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["A", 
      RowBox[{"-", "1"}]], "=", 
     RowBox[{"Inverse", "[", 
      RowBox[{"A", ",", " ", 
       RowBox[{"Modulus", "\[Rule]", "mod"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"z", " ", "=", " ", 
    RowBox[{"Mod", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["A", 
        RowBox[{"-", "1"}]], ".", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Transpose", "[", "y", "]"}], "-", "b"}], ")"}]}], ",", 
      "mod"}], "]"}], 
    RowBox[{"(*", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "3", "}"}], ",", 
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "3", "}"}], ",", 
       RowBox[{"{", "1", "}"}], ",", 
       RowBox[{"{", "6", "}"}]}], "}"}], " ", "*)"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7923430743929267`*^9, 3.7923430883884993`*^9}, {
   3.792343137477828*^9, 3.7923432669778013`*^9}, {3.7933678545079613`*^9, 
   3.793367856451582*^9}, {3.7975016453509693`*^9, 3.797501648713416*^9}, 
   3.797666581676016*^9},
 CellLabel->
  "In[1046]:=",ExpressionUUID->"b055f34a-b0b8-4a63-a634-9a485847eb91"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"*", " ", "Test", " ", "of", " ", 
    RowBox[{"correctness", "/", "Verification"}], " ", "of", " ", 
    "signature"}], " ", "**)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"w2", "=", "w"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"w2", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"P3", " ", "@@", " ", 
        RowBox[{"z", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{"P4", " ", "@@", " ", 
        RowBox[{"z", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{"P5", " ", "@@", " ", 
        RowBox[{"z", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{"P6", " ", "@@", " ", 
        RowBox[{"z", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "1"}], "]"}], "]"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"True", "?"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Mod", "[", 
     RowBox[{"w2", ",", "mod"}], "]"}], "\[Equal]", "w"}]}]}]], "Input",
 CellChangeTimes->{{3.79234385299122*^9, 3.79234389365147*^9}, 
   3.79234393721381*^9, {3.7923442760112424`*^9, 3.7923443501473646`*^9}, {
   3.7988060710771847`*^9, 3.798806071897752*^9}, 
   3.798806974303853*^9},ExpressionUUID->"90e47ef7-6459-4003-9f9b-\
1fc8c5003e32"]
},
WindowSize->{858, 782},
WindowMargins->{{-7, Automatic}, {Automatic, 0}},
Magnification:>0.9 Inherited,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 14271, 280, 551, "Text",ExpressionUUID->"df10ed9f-b056-41f1-9bc5-ba19d50e8221"],
Cell[14832, 302, 7110, 202, 784, "Input",ExpressionUUID->"b4b7858b-fbc4-4973-b765-1f0c8ce5b755"],
Cell[21945, 506, 5321, 134, 315, "Input",ExpressionUUID->"74fbdeb8-436c-4c96-b6ba-83a14910a94c"],
Cell[27269, 642, 962, 20, 45, "Input",ExpressionUUID->"045dfbba-fe0f-4098-929c-730016040cb2"],
Cell[28234, 664, 913, 28, 63, "Input",ExpressionUUID->"1f1d763f-1413-402e-9377-8a33c104e646"],
Cell[29150, 694, 1562, 30, 63, "Input",ExpressionUUID->"984a135c-ac22-480a-86bc-e8d76a01d8c9"],
Cell[30715, 726, 1277, 30, 81, "Input",ExpressionUUID->"076d4c63-501e-464f-a4ef-2162a62358ca"],
Cell[31995, 758, 1390, 37, 63, "Input",ExpressionUUID->"da7355a4-f739-4489-9771-a23eae823033"],
Cell[33388, 797, 1163, 30, 63, "Input",ExpressionUUID->"2f3e0565-f4a5-487e-bb37-5fe2c5f6205a"],
Cell[34554, 829, 1465, 38, 63, "Input",ExpressionUUID->"da5400f8-0310-47ab-af20-65e4dd3f4c6e"],
Cell[36022, 869, 1731, 37, 63, "Input",ExpressionUUID->"0328917d-e1ad-4b1e-ad9f-c846ea635503"],
Cell[37756, 908, 1397, 40, 63, "Input",ExpressionUUID->"b055f34a-b0b8-4a63-a634-9a485847eb91"],
Cell[39156, 950, 1468, 39, 99, "Input",ExpressionUUID->"90e47ef7-6459-4003-9f9b-1fc8c5003e32"]
}
]
*)

