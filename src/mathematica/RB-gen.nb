(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     39377,        882]
NotebookOptionsPosition[     38406,        862]
NotebookOutlinePosition[     38748,        877]
CellTagsIndexPosition[     38705,        874]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "\[OpenCurlyDoubleQuote]Rainbow\[CloseCurlyDoubleQuote] signature scheme is \
part of Multivariate cryptography. In this sheet is a basic example with \
generated values/instance for specific parameters which follows the workflow \
below, where \[OpenCurlyDoubleQuote]w\[CloseCurlyDoubleQuote] is hash of some \
message and \[OpenCurlyDoubleQuote]z\[CloseCurlyDoubleQuote] is its \
signature:\n",
 Cell[BoxData[
  GraphicsBox[
   TagBox[RasterBox[CompressedData["
1:eJztnQd0FFXUxxEjkSoISg9SxUiHAwGkKIZyKCIgRSAQelUPfFQBAZFEkCoi
vVdBCD0B6U16EVA6CCLSawBF78f/fWf2m2xmd2ezQ3az+f/OGdidnXmZmXfn
vttmXt42nzbokDJFihQ9X372T4PwPu/26BHer2HGZ18++qRn546ftG9X65P/
ad+xfY+QNi8+W/nNsyXwhRQpAp79L4QQQgghhBBCCCGEEEIIIYQQQgghhBBC
CCGEEEIIIYT4OVevXpWJEydK8+bNpXr16lKtWjW1NGjQQAYOHCiHDh3y9iES
QhKRv//+W/r27StffPGFREdHS7ly5aRRo0Zy5MgR2bJli4wePVrefvttSZky
pYwcOdLbh0sISSR69+4tX331le17njx5ZNy4cXG2efz4sZQvX17SpEkj//33
X2IfIiHEC+zfv992v9+/f1/wiP7mzZvjbQebIW/evIl8dIQQX2Dfvn1KN9y4
cSPebw0bNpRJkyZ54agIId5m9uzZkjNnznjrZ8yYIcOGDfPCERFCfIFu3bpJ
y5Yt5d9//5WjR48qXYF4xOLFi719aIQQLwF9kCNHDlm6dKm0b99eevXqJT/+
+KM8ffrU24dGiM9w9+5dqVmzpi3H72r54IMP1L2F/b788ktp0aKF/P777zJv
3jz5/PPPpUePHjJlyhRvn5ZTtm/fLhkzZpQnT554+1D8js6dO5uWpRo1asiJ
EydUfBj5ok6dOsmyZcvk2LFjMnbsWOXbdejQQeWep0+frnLMzZo1k4ULF3r7
NJMN9+7dU/b0nDlz5J9//lGfcf3xGXVC27Ztk1atWslHH30k7733norxf/fd
d3L79m1VP1SqVCn5+eefVVtnz56Vl156SfWnr9K9e3dp06aNtw/DL4G+Xb58
ubRt21bJz5o1a6RLly4qN3znzh05cOCADB48WEJCQqRr166yatUqVWu2du1a
mTp1qmTLlk0WLVpkay9fvnzStGlTOXXqlPq+adMmyZUrl7dOL1myYsUKW70P
6gP/+OOPeNvAHkBsH7oBfQRQKzRkyBDbNhs3bpTXXnvNZ2sD4Ddkz55dYmJi
vH0ofgtsytq1a6vP48ePl/nz58fb5uDBg5I2bVqlGzD2YCyBrkCOSAN9hToT
2Awa+FyyZMnnfxJ+Amx8jNvIu+H6Qmdri9lcHPpI0w3wG65fv277DTY47nUs
+fPnV7oB/PXXX0pXXLx40bYtag6xv6+C8WfQoEHqmhFjTp48qXzEnj17xpEl
+ItmdD7kQ9MNY8aMkSVLlth+gw+h5Y3RJuROIzg4WP1djcOHD0tgYKA8fPjQ
ti48PFzJOHHNL7/8Iu+8847Ur19fvvnmG2XDoZ5HW86cOWOqHWe64c0335RH
jx6pz2hTkw/E9PU1QliPbTFOPHjwQM6fP2/RWSZdqlatKrdu3fL2YZgCfQ5f
q2zZssoWRHxWL0uoHTODM93QsWNHWbdunfp8/Phx5bMC/I9x5sKFC7ZtEXOo
VKmS7Tv8FcSJduzYoba/du2ax+fsq+DawOY6ffq0bR389StXrpjaH3Y9bPrd
u3d7fCyOdAOOB32m6QY9iDvp/XaMyXgWATZlZGSk6fPwZz777DMVx7ECjJ/w
62bNmqV8eT3QP+fOnbN9h003c+ZM07kX3GuFChWSuXPnemxTOdINiDkULFjQ
phv0YJxBbEEPxjvYeBqQ9yxZsqgxqE+fPhIbG+vRcfoq8HdTpUolAQEBkilT
Jtm7d6/qz9atW8frdyOgM4sUKWLaLnCFvW6ATsAxQm/nzp3bUDdgfEEeUAO2
InQV9J3eR0zOQO+jn4yunztoz4lB3zZu3Fi+/fbbOL/DT69Xr57tO7aFTscY
6wroAuSqYCdYgb1ugL5BfAFxrKJFixrqBsS/ESPWExQUJLt27bJ9x7UsXbq0
jBo1SuUz/BH0Bfwm5P5gJ+3Zs0fdT2XKlJE///zTVBsYj7CPVdjrhhIlSqhY
EeIHyE0YyTbizvZArxmtT85g7IMt7cl4DF2L3B5AjB91Wxq45hkyZJChQ4fa
1l26dEmtg4/piqioKHXfWoW9bkCMKmvWrBIaGioDBgww1A3Yx97GMZIj2B5a
vMtf0cdXMCZ8+umn8ttvv5nev3Dhwpb680Y+BfQWdDlykp6Oe8kZyHy7du2k
SZMmCfaRtTpu9MuLL74o06ZNs/2GsQU2AuL9emBL6OPEjoDegv9hFUY+BfwA
2A/IOxjpBhIf3HOIuyL24A6IyRQvXtzlAtvSDI7iDdAPGH8SUzds2LDB4fkg
/5g6dep4C56NMNoe9Y8FChQwda2cbQ+/yujvYjHTfrFixVQsBrYY8rzuosV/
kXdCO/A/NSIiIuTll19WY6oe5AHM5BXq1q2r4gCuzgHjvqd5Cvgu1A2uwTWE
XjCj2+1BfgA+CdpwtpiJXQBneQqMWYmZ84P8OTof2JmIm9kvWO9oe9R2ubpO
rrZ39HexmGl/woQJKu6AGI4ntR/Ie6CmUA/uWft1+BuoUzVDWFiYqnVzdQ72
uscRznQD4lOab0SMuXnzpqoH1XI4GmbjDR9//HGc+jFPcaYbiGcgxlexYkWP
c5nwPeHfIbenAR3wyiuvqHfZ6UG9C+rZzIDcB+qVrcKZbiDOQY4Pz/hAP+hZ
v359vPizI1AXgtgl6gisgLrh+YC6cth4VuRzYV8irrB69WrbOsgS1sGX19O/
f3/TfiDsHsSe3fVrHUHdkDCg++vUqaN8CdQHwNaETkA+AP3jTs4Wz6cgBwz5
8BTEtlDPDhA3syo3mtwZPny4jBgxwpK2ENNE7Ecfh8Q7cRHD0L/rDvUu7j5r
jnfdoC7Rin5HG3jOBqDOUX+8xDGoCdJytniHKZ49gN5HrEdfE2YG2JOTJ09W
OQvoCdSt6fMfZoBeqVy5soqpoTahSpUq6j2K6dOnV3YJ3rFKEk6FChXi1CR5
Cp5jwrNtuOegc2DrrVy5UsU6kfNHvgH6KCExDfQ15BDPrG/dutXwnViugJ+c
OXNmFRuGLKE91PFA71iZc/dH7H1O2HOe6mrEKBCrRo4M9zfyydqCfibeA88m
WA30P55dRCxaA3FCvKPGU98F7WC8QY4DdUZ6WcK97qvP0BFCCCGEEEIIIYQQ
QgghhBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIYQQQgghvoLZ99ATQpIXmNua
EE/Be5Ax94G/zzmXnKBuIJ6CuYswNx7eC4u5M83OY0N8G+oG4gknTpxQ+gBz
8ECWNm/erObJs/L92cQ7UDeQhIJ581q0aGF7X7YmS5inG/M7Yz53knShbiAJ
5fLly3G+28uS/e8kaUHdQKyCsuRfsD+JVVCW/Av2J7EKypJ/wf4kVkFZ8i/Y
n8QqKEv+RaFChbx9CMRPoCwlTc6ePStPnjyJtz59+vReOBqSlEDdI+bndgVl
yXdAf02YMEEaNWokFStWdLjUqlVLhg4dajgHOu1AYsTTp09l8eLFUr16dQkK
CpIUKVLIW2+9JVFRUQ73oSz5BseOHVP3/IYNG2T37t1qQV+iD+fMmWNbt2/f
PomNjXXYDvuT2AP7Es9NQQ/gGSqMKbA7CxcuLCEhIQ73oyx5H+j0EiVKyPLl
y+Os//777yVdunRuPXfN/iT2TJs2TYoWLRpvfWRkpCxYsMDhfpQl73Pjxg3Z
uXNnvPVNmjSRmjVrutUW+5PY061bNwkMDLQ9J2EWypJvArsvW7ZsEhER4dZ+
7E9iz5EjRyRTpkySIUMG9TwVxiIzUJZ8k19//VXFGhBjcAf2JzHi5s2b0r9/
f5V7gJ+Kz658VcqSb4JYQ5o0aVTsyB3Yn0SPvY1w+/Zt9bw1xp1+/fo53Zey
5Jsg1hAaGur2fuxPAmAThIWFyYoVK+L9Bn8VufDy5cs7bYOy5HugNiVr1qyq
1sFd2J8EIF8J2+DOnTuGv3/44YfKr3AGZcn32LZtmwQEBMi1a9fc3pf9ScDa
tWuVbggPD5dHjx7F+S06OlqaNWvm8j2QlCXfA+/xrFOnToL2xbv+CIHfMGDA
APU+WNigjRs3llatWknLli1l8uTJpmpmYFsQ3wE1bMHBwbJnz54E7U9dT/TA
9ly/fr3ExMTI+fPnlb9qFsqSb4G+czc3oYf9SayCsuRfsD+JVVCW/Av2J7EK
ypJ/wf4kVkFZ8i/Yn8QqKEv+BfuTWAVlKWmD3JQ+V63vT+Q8UANDSEKgbkja
LFmyRBo2bKjmNgVaf/7000/qmYypU6d68/BIEoa6IemDeohBgwapOji8G3jc
uHFqXlP7WllC3IG6wX8YM2aMqqHH+zsI8RTqBv8BNfSjRo1S758kxFP4bA4h
hBBCCCGEEEIIIYQQQgghhBBCCCGEEEIIIb4P6sjxrGqjRo2kSpUqhsu7776r
5mu4e/eutw+XEJJI7Nu3T+bOnSsnTpxQ8w+XLl1aunTpoj5jOXbsmMycOVN6
9uxpas4GQoj/gXsf88xv3brV24dCCPEhNm/eLJkyZaJ9QAiJA+aWb968ubcP
gxDiQyAm+cYbb0ixYsXUO/S0ZdasWd4+NEKIF0GMIVu2bLJp0yblW2BZuXKl
PHz40NuHRohP0LlzZ6lWrZqppUaNGiq+7w/Uq1dPIiMjvX0YfsGkSZNMyxCW
H374wduHTEyAebqXL18ubdu2VTG5NWvWqJze48eP5c6dO3LgwAEZPHiwhISE
SNeuXWXVqlXKHsf7aTt16qTmZN65c6f06dNHhg4dqt5Z6+vvoDt58qRkzJhR
nR/xHMxtcObMGSlTpoySIdSF4PO9e/ckNjZWjSd4v3mJEiUkIiJC5Yf1MrRs
2TKVOx47dqwMGzZMOnTooN6HPH36dBk9erSqNVm4cKG3TzNZgr6sXbu2+jx+
/HiZP39+vG0OHjwoadOmVboBnzHPBfo7V65cqh5AI3fu3LJly5bEOnTTLF68
WE6dOqU+Qx779+/v5SPyPypXrqz+P3r0qLRv3z7e77dv35bg4GClGw4dOmST
Ifh2ixYtsm2XL18+adq0qa2/4PdBzoj7YBycN2+euuYY/7WlR48eSj+74v79
+zbdgHdTo25QAzr/xo0b6jPahG7Ytm2b0uuwI1BDqIF33AcEBMjx48ctPkPP
wPHDTsiTJ496N3/dunWVvUT+H09lCKCmFOC+h2xowD6DvgCoO8Pf0MsQYsAa
sDnTpEmjbAYNfC5ZsqQFZ5l8uH79urRp00bKli0rQ4YMUfPVaHE1LPv37zfV
jjPd0LFjR1m3bp36jHv+6tWrtt8wBsyePdv2XasXgI3pa6DmceTIkbJ69WrT
su4pVatWlVu3biXK30ooVskQcKQb4A/A5wSan6oBGYJO0jh8+LAEBgbGiQmH
h4fHac9fuXTpkvKh4Kfbg+sGv80MuEcxLw30sKf3oiPdgJhDwYIFbbrB/u9j
7osLFy7Y1kGPaLakr9kO3gCxlzlz5ljeLvTNggUL1Hh67do1tQ7+OuQKus+s
PFgpQ8CRbmjVqpVNN9j/fXsZQsyhUqVKtu+w72Dz7dixQ22vna+/cfnyZRk4
cKA8ePBAsmfPLkeOHInzO3ys999/32U76MeaNWva5rXzFHvdAFlBTAHzERQt
WtRQN8B/h1+oJ0eOHCqWuX37dlm6dKklx5aUOX36tBQpUsTS+cQwrsIvgp+0
d+9eVaOB/vn666/VuINxGDrCFVbLENDrBsR0zp07p+I68AeMdIORDNWvX1+d
nwZiDVmyZFG2HtpAbNMfwXXCWAx7CX75jBkzbL+hr1599VXp27evy3aioqIs
nUfEXjfkz59fsmbNKqGhoWrePCPd0Lt3b+nevXucdbVq1VJxZug/X89VJBaQ
c9hTVozLkBuMx5pPhP/hw5UqVUp9RmwP47DeJ3SE1TIE9Lrh9ddflwIFCqgx
EDrASDcYyVBQUJDs2rXL9h36Fc/DYQ4m5DP8Eeg7nB+A3Yc+hF7VgA2BddHR
0S7bgqzpcwOeYuRTQNZgPyAuZKQbsI/9/Y99tLgl+T9wjdq1a6fmKfbUHoYf
AVtBA/IDmUEcRQO5ADNYLUPAyKdAbAG2jZFuMJIho7wyxlNs689o+h41/Mj1
6kHuELaEmWuAODviAMWLF3e6YNz3NE8Bu9NINzwvNmzY4PB8MAalTp063pIz
Z07D7eHjYOxydZ1cbY+8rNHfxWKmfdRlp0yZUuWAN27cmOBrY9+XiOFBN+Be
dBerZQg4ijegxsxIN5C4wC5Mly6dDB8+PM562Hfly5c31UZYWJiK/eKedrZA
35rBmW5A3ABxrsQCcujofDCmIB5lv2C9o+1Rf+PqOrna3tHfxWKm/QkTJqi4
Q0xMjKU5EtS0Ik6XEP/NahkCjnQD/AKjmhkSF8RboesR69OAL5o5c2bp16+f
qTamTJmiYj1W4Uw3EM9ArK9ixYrPJZeJcb1OnTpx1l25csXUvlbLEHCkG4g5
EH+EbtDnb1EXgnUYV8yAsQo+iVV5QuqG5wN8/7x585q+X12BmNTu3bvVZ8Qu
4Kegnl0D9cqoNzaD1TIEqBs8A/409IA2jsDGhD+BWANym2bBu82QrzJbD+EM
tKG9xwA+7LRp0zxuk4jyG0eMGGFJWxhLEK/QctzIfyD+guecNCZOnBgnVukK
K2UI4JkbgFx9ixYtLGkzOQH/ATFr6FXkkZCzRM6wQoUKbreF5xZgV/bq1Us9
c5yQHAHGGfgziOdB76O9VKlSKZlBfJQkHPSpPhflCYgplCtXTuWIoQPgE8A/
Rc06cpeob0BtibtYIUPQT6hTgO6CDOG5ihdeeEHZTK1bt3a7veQOZAYxPtgK
iHfDlk8IiBVNnjxZ1b4jDww9oy3op8SqDybxwTMKVoK+xBivr1tHnBS+hif1
JJQh7wN/AnYX4rYaqBHF+0zN5qUJIf4HfHrY7ufPn1ff4Zeh/hA2ISEk+YL3
3cBOuHjxosoF4Dk9M3WQhBD/B/lKPD+H59etfAaHEEIIIYQQQgghhBBCCCGE
EEIIIYQQQgghhBBCCCGEEEIIIYQQQp43/wt1Zh/9
     "], {{0, 140}, {263, 0}}, {0, 255},
     ColorFunction->RGBColor],
    BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
    Selectable->False],
   DefaultBaseStyle->"ImageGraphics",
   ImageSizeRaw->{263, 140},
   PlotRange->{{0, 263}, {0, 140}}]], "Input",ExpressionUUID->
  "569587b0-6d67-4e6f-bc08-1fca9656a98a"],
 "\nExample is composed of five parts:\n1) Setting up of values and \
parameters for the example:  Modulus of finite field \
(\[DoubleStruckCapitalF]) \[OpenCurlyDoubleQuote]mod\[CloseCurlyDoubleQuote] \
, number of vinegar variables \[OpenCurlyDoubleQuote]vinVars \
\[OpenCurlyDoubleQuote] and number of oil variables in each of the layers \
\[OpenCurlyDoubleQuote]oilVars\[CloseCurlyDoubleQuote].\n2) Generation of \
central map  \[ScriptCapitalF], affine map  \[ScriptCapitalT] and affine map \
\[ScriptCapitalS].  ",
 StyleBox["Private key",
  FontWeight->"Bold"],
 " is a triplet of  \[ScriptCapitalS],  \[ScriptCapitalF] and  \
\[ScriptCapitalT].\n3) Computation of ",
 StyleBox["public key",
  FontWeight->"Bold"],
 " \[ScriptCapitalP] by composition of  \[ScriptCapitalS],  \[ScriptCapitalF] \
and  \[ScriptCapitalT]:  \[OpenCurlyDoubleQuote]\[ScriptCapitalP] = \
\[ScriptCapitalS] o \[ScriptCapitalF] o \[ScriptCapitalT]\
\[CloseCurlyDoubleQuote]. When applied to the signature, we will get the \
hash: \[OpenCurlyDoubleQuote]w = \
\[ScriptCapitalP](z)\[CloseCurlyDoubleQuote].\n4) Computation of signature \
\[OpenCurlyDoubleQuote]z\[CloseCurlyDoubleQuote] from hash \
\[OpenCurlyDoubleQuote]w\[CloseCurlyDoubleQuote] in three steps:\n\t1] Get \
\[OpenCurlyDoubleQuote]x\[CloseCurlyDoubleQuote]: \[OpenCurlyDoubleQuote]x = ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ScriptCapitalS]", 
    RowBox[{"-", "1"}]], TraditionalForm]],ExpressionUUID->
  "e07b57a4-f252-498b-90fa-3c10cadc71f3"],
 "(w)\[CloseCurlyDoubleQuote]\n\t2] Get pre-image \[OpenCurlyDoubleQuote]y\
\[CloseCurlyDoubleQuote] of \[OpenCurlyDoubleQuote]x\[CloseCurlyDoubleQuote]: \
\[OpenCurlyDoubleQuote]y = ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ScriptCapitalF]", 
    RowBox[{"-", "1"}]], TraditionalForm]],ExpressionUUID->
  "56b5dbb1-9f10-4f56-b5c3-7c27149bdd78"],
 "(x)\[CloseCurlyDoubleQuote], in this step the pre-image is computed part by \
part from \[OpenCurlyDoubleQuote]",
 Cell[BoxData[
  FormBox["oilVars", TraditionalForm]],ExpressionUUID->
  "fc5c80d8-34bb-4e64-a279-e42c70ad1347"],
 "\[CloseCurlyDoubleQuote] and that is the main difference from UOV. The \
length of \[OpenCurlyDoubleQuote]",
 Cell[BoxData[
  FormBox["oilVars", TraditionalForm]],ExpressionUUID->
  "fec0515d-ceb6-4edc-9742-01869c1104a8"],
 "\[CloseCurlyDoubleQuote] is number of parts (layers) of the computation.\n\t\
3] Get signature \[OpenCurlyDoubleQuote]z\[CloseCurlyDoubleQuote]: \
\[OpenCurlyDoubleQuote]z = ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ScriptCapitalT]", 
    RowBox[{"-", "1"}]], TraditionalForm]],ExpressionUUID->
  "7bbf283c-a1fd-4aa9-be84-e115cf3a5d2a"],
 "(y)\[CloseCurlyDoubleQuote]\n5) Check if hash \[OpenCurlyDoubleQuote]w\
\[CloseCurlyDoubleQuote] is is equal to  \[ScriptCapitalP](z):\n\t\
\[OpenCurlyDoubleQuote]w == \[ScriptCapitalP](z)\[CloseCurlyDoubleQuote] \n\t\
\t\t=> It should be true because: \[OpenCurlyDoubleQuote]z = ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ScriptCapitalT]", 
    RowBox[{"-", "1"}]], TraditionalForm]],ExpressionUUID->
  "e41a097d-191e-44f3-bbe7-987dc3a60d67"],
 "(",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ScriptCapitalF]", 
    RowBox[{"-", "1"}]], TraditionalForm]],ExpressionUUID->
  "5b1fc0dd-1e52-4244-9b9c-a1ac676bc803"],
 "(",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ScriptCapitalS]", 
    RowBox[{"-", "1"}]], TraditionalForm]],ExpressionUUID->
  "c588ec85-0b76-4d81-8ab0-91552099eced"],
 "(w)))\[CloseCurlyDoubleQuote] and \
\[OpenCurlyDoubleQuote]\[ScriptCapitalP](z) = \[ScriptCapitalS](\
\[ScriptCapitalF](\[ScriptCapitalT](z)))\[CloseCurlyDoubleQuote], so: \n\t\t\t\
\[OpenCurlyDoubleQuote]\[ScriptCapitalP](z) = \[ScriptCapitalS](\
\[ScriptCapitalF]( \[ScriptCapitalT](",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ScriptCapitalT]", 
    RowBox[{"-", "1"}]], TraditionalForm]],ExpressionUUID->
  "c423b407-2452-4100-a1cf-1b5dd36dcb6f"],
 "(",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ScriptCapitalF]", 
    RowBox[{"-", "1"}]], TraditionalForm]],ExpressionUUID->
  "58aba264-a8b6-4f57-a6c1-3a8705c7635a"],
 "(",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ScriptCapitalS]", 
    RowBox[{"-", "1"}]], TraditionalForm]],ExpressionUUID->
  "43f28f3e-aa8b-4ca7-9478-eae4b2c36870"],
 "(w)))))) = S(\[ScriptCapitalF](",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ScriptCapitalF]", 
    RowBox[{"-", "1"}]], TraditionalForm]],ExpressionUUID->
  "e63e615c-bd94-4052-bb51-683d12b37f92"],
 "(",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ScriptCapitalS]", 
    RowBox[{"-", "1"}]], TraditionalForm]],ExpressionUUID->
  "e56f5466-87e5-4ef1-b1e1-68b97b16558d"],
 "(w)))) = \[ScriptCapitalS](",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[ScriptCapitalS]", 
    RowBox[{"-", "1"}]], TraditionalForm]],ExpressionUUID->
  "d7be3aa4-329d-4143-bebd-71e967a95924"],
 "(w)) = w\[CloseCurlyDoubleQuote].\n"
}], "Text",
 CellChangeTimes->{
  3.7975027472207727`*^9, {3.7975028823976727`*^9, 3.79750298237402*^9}, {
   3.7975031386151304`*^9, 3.797503147857005*^9}, {3.797503192252347*^9, 
   3.7975031924335313`*^9}, {3.7975032925048037`*^9, 
   3.7975034764924192`*^9}, {3.797666834564022*^9, 3.797666835713264*^9}, {
   3.7976668836610394`*^9, 3.797666885897441*^9}, {3.7976669276037045`*^9, 
   3.797667066440903*^9}, {3.798793659034367*^9, 3.7987936592383556`*^9}, {
   3.798793705538124*^9, 3.7987937519603405`*^9}, {3.7987944148050385`*^9, 
   3.7987944183912983`*^9}},ExpressionUUID->"e01c60df-0cde-4d23-b2c1-\
173ccb3d81be"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"**", " ", "Parameters"}], " ", "***)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mod", "=", "13"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"vinVars", "=", "2"}], ";", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"Number", " ", "of", " ", "vinegar", " ", "variables"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"oilVars", "=", 
    RowBox[{"{", 
     RowBox[{"2", ",", "2", ",", "1"}], "}"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Number", " ", "of", " ", "oil", " ", "variables", " ", "in", " ", 
    "layers"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"u", "=", 
    RowBox[{"Length", "[", "oilVars", "]"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Number", " ", "of", " ", "layers"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"n", "=", 
    RowBox[{
     RowBox[{"Total", "[", "oilVars", "]"}], "+", "vinVars"}]}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Number", " ", "of", " ", "variables"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m", "=", 
   RowBox[{"n", "-", "vinVars"}]}], ";", " ", 
  RowBox[{"(*", " ", 
   RowBox[{"Number", " ", "of", " ", "oil", " ", "variables"}], " ", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "Generate", " ", "central", " ", "map", " ", 
    "\[ScriptCapitalF]"}], " ", "**)"}], "\[IndentingNewLine]", 
  RowBox[{"F", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"numOfX", "=", "n"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "u"}], ",", 
    RowBox[{"i", ">", "0"}], ",", 
    RowBox[{"i", "--"}], ",", "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", 
        RowBox[{"oilVars", "[", 
         RowBox[{"[", "i", "]"}], "]"}]}], ",", 
       RowBox[{"j", ">", "0"}], ",", 
       RowBox[{"j", "--"}], ",", "\[IndentingNewLine]", "\t\t", 
       RowBox[{
        RowBox[{"variablesOfX", " ", "=", " ", 
         RowBox[{"Prepend", "[", " ", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             SubscriptBox["x", "i"], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "numOfX"}], "}"}]}], "]"}], ",", "1"}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"vinegarOfX", " ", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{"1", ",", 
             RowBox[{
              RowBox[{"oilVars", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "+", "1"}]}], "]"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             SubscriptBox["x", "i"], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"numOfX", "-", 
                RowBox[{"oilVars", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}]}], "]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"matrixF", "=", 
         RowBox[{"RandomInteger", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", 
             RowBox[{"mod", "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"numOfX", "+", "1"}], ",", 
             RowBox[{"numOfX", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t\t", 
        RowBox[{"tmpF", " ", "=", " ", 
         RowBox[{"PolynomialMod", "[", 
          RowBox[{
           RowBox[{"Simplify", "[", 
            RowBox[{"variablesOfX", ".", "matrixF", ".", "vinegarOfX"}], 
            "]"}], ",", "mod"}], "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
        RowBox[{"F", " ", "=", " ", 
         RowBox[{"Prepend", "[", 
          RowBox[{"F", ",", "tmpF"}], "]"}]}], ";"}]}], "\[IndentingNewLine]",
       "\t", "]"}], ";", "\[IndentingNewLine]", "\t", 
     RowBox[{"numOfX", "=", 
      RowBox[{"numOfX", "-", 
       RowBox[{"oilVars", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}]}], ";"}]}], "\[IndentingNewLine]", 
   "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "In", " ", "the", " ", "\[ScriptCapitalF]", " ", "only", " ", "the", " ", 
     "vinegar", " ", "variables", " ", "can", " ", "by", " ", "quadratic", 
     " ", "because", " ", "in", " ", "the", " ", "computation", " ", "of", 
     " ", "the", " ", "pre"}], "-", 
    RowBox[{
    "image", " ", "we", " ", "substitute", " ", "them", " ", "with", " ", 
     "concrete", " ", "value", " ", "and", " ", "we", " ", "get", " ", 
     "linear", " ", "equations"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "*", " ", "Generate", " ", "regular", " ", "matrix", " ", "\"\<A\>\""}], 
    ",", " ", 
    RowBox[{
     RowBox[{"it", "'"}], "s", " ", "inversion"}], ",", " ", 
    RowBox[{
    "vector", " ", "\"\<b\>\"", " ", "and", " ", "affine", " ", "map", " ", 
     "\[ScriptCapitalT]"}]}], " ", "**)"}]}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{",", "True", ",", ",", "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"A", "=", 
     RowBox[{"RandomInteger", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"mod", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]",
     "\t", 
    RowBox[{"Check", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["A", 
        RowBox[{"-", "1"}]], "=", 
       RowBox[{"Inverse", "[", 
        RowBox[{"A", ",", " ", 
         RowBox[{"Modulus", "\[Rule]", "mod"}]}], "]"}]}], ",", 
      RowBox[{"Continue", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    "\t", 
    RowBox[{"Break", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"RandomInteger", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"mod", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"T", "=", 
    RowBox[{
     RowBox[{"A", ".", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         SubscriptBox["x", "i"], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], "+", "b"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "*", " ", "Generate", " ", "regular", " ", "matrix", " ", "\"\<A2\>\""}], 
    ",", " ", 
    RowBox[{
     RowBox[{"it", "'"}], "s", " ", "inversion"}], ",", " ", 
    RowBox[{
    "vector", " ", "\"\<b2\>\"", " ", "and", " ", "affine", " ", "map", " ", 
     "\[ScriptCapitalS]"}]}], " ", "**)"}]}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{",", "True", ",", ",", "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"A2", "=", 
     RowBox[{"RandomInteger", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"mod", "-", "1"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"m", ",", "m"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]",
     "\t", 
    RowBox[{"Check", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["A2", 
        RowBox[{"-", "1"}]], "=", 
       RowBox[{"Inverse", "[", 
        RowBox[{"A2", ",", " ", 
         RowBox[{"Modulus", "\[Rule]", "mod"}]}], "]"}]}], ",", 
      RowBox[{"Continue", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
    "\t", 
    RowBox[{"Break", "[", "]"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b2", "=", 
   RowBox[{"RandomInteger", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"mod", "-", "1"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "1"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S", "=", 
   RowBox[{
    RowBox[{"A2", ".", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        SubscriptBox["x", "i"], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "m"}], "}"}]}], "]"}]}], "+", "b2"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.797249946617955*^9, 3.79725000076717*^9}, {
   3.7972500358982553`*^9, 3.797250052992417*^9}, {3.7972503651409025`*^9, 
   3.7972503778280306`*^9}, {3.7972504886695843`*^9, 3.7972505421637774`*^9}, 
   3.7972506009622726`*^9, {3.7972508112162747`*^9, 3.7972508404072266`*^9}, {
   3.7972509423950343`*^9, 3.7972509432039213`*^9}, {3.797250990590002*^9, 
   3.7972509923124824`*^9}, {3.7972510332803683`*^9, 3.797251061272497*^9}, 
   3.7972511446603923`*^9, {3.797251309602079*^9, 3.7972513183569455`*^9}, {
   3.7972514724034076`*^9, 3.797251482243409*^9}, {3.797251824050336*^9, 
   3.797251878665184*^9}, {3.797252038889285*^9, 3.7972520692451687`*^9}, 
   3.7972521340061774`*^9, {3.7972522030129156`*^9, 3.7972522118403263`*^9}, {
   3.797252268243724*^9, 3.797252289505952*^9}, {3.7972523216142197`*^9, 
   3.797252342876461*^9}, {3.7972524258249674`*^9, 3.7972524999410963`*^9}, {
   3.7972525305653267`*^9, 3.797252627121521*^9}, {3.797252657968149*^9, 
   3.797252704974639*^9}, {3.7972527463860383`*^9, 3.797252766625027*^9}, {
   3.79725470221954*^9, 3.7972547610830483`*^9}, {3.7972547950052395`*^9, 
   3.797254796201277*^9}, {3.797254828826419*^9, 3.7972549174310493`*^9}, {
   3.7972553292173133`*^9, 3.7972553437332783`*^9}, {3.797255812686487*^9, 
   3.7972558242847557`*^9}, {3.7972559606012096`*^9, 
   3.7972559729792857`*^9}, {3.7972575737223387`*^9, 3.797257574762327*^9}, 
   3.7972576256117487`*^9, 3.797257913111907*^9, 3.797259545476879*^9, 
   3.797259693478315*^9, {3.797259764379583*^9, 3.7972597759315047`*^9}, {
   3.7972598069589615`*^9, 3.797259807221261*^9}, {3.7972601573816032`*^9, 
   3.797260158508355*^9}, {3.797260194942133*^9, 3.79726019519749*^9}, {
   3.7972612201325836`*^9, 3.7972612528478394`*^9}, {3.797261800933148*^9, 
   3.7972618047572784`*^9}, {3.797261843309181*^9, 3.7972618656119084`*^9}, {
   3.797261932726142*^9, 3.7972619881631546`*^9}, {3.797262254645711*^9, 
   3.79726225772814*^9}, {3.797262944138035*^9, 3.797263024423787*^9}, {
   3.7974345475768137`*^9, 3.7974345495006785`*^9}, {3.797502779557995*^9, 
   3.7975027916195664`*^9}, {3.7975029959998307`*^9, 3.79750301283558*^9}, {
   3.7975030587793694`*^9, 3.797503121648902*^9}, {3.7976671060869164`*^9, 
   3.79766713592377*^9}, {3.797667194920108*^9, 3.7976672051717215`*^9}, {
   3.797856024509063*^9, 3.7978560259049225`*^9}, {3.798204330765834*^9, 
   3.7982043362960725`*^9}, {3.798204375891229*^9, 3.798204424657877*^9}, 
   3.798204464060564*^9, {3.79820454150452*^9, 3.7982045418526382`*^9}, {
   3.79820462963299*^9, 3.7982046527861032`*^9}, {3.7982046914806657`*^9, 
   3.7982047428164563`*^9}, {3.798204807772827*^9, 3.7982048137877584`*^9}, 
   3.7982048578190517`*^9, {3.7982049118127327`*^9, 3.798204933456871*^9}, {
   3.798204968967949*^9, 3.7982049890891657`*^9}, {3.798205067004901*^9, 
   3.798205073015805*^9}, {3.798205205335633*^9, 3.7982052079646053`*^9}, {
   3.7982054988480988`*^9, 3.79820550253623*^9}, {3.7982055981546636`*^9, 
   3.798205602631685*^9}, {3.7983526305297203`*^9, 3.7983526311139803`*^9}, {
   3.7983526883864985`*^9, 3.798352711812299*^9}, {3.7983528840344925`*^9, 
   3.7983528927133694`*^9}, {3.798352932265241*^9, 3.7983529324537687`*^9}, {
   3.7988061125887847`*^9, 3.7988061129337997`*^9}, {3.7988061791780767`*^9, 
   3.798806232016697*^9}, {3.7988062771763554`*^9, 3.798806280693805*^9}},
 CellLabel->
  "In[640]:=",ExpressionUUID->"a2ffbd8b-bea5-4d77-b279-6ea5a3abb6df"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "Compute", " ", "public", " ", "key", " ", 
    "\"\<\[ScriptCapitalP] = \[ScriptCapitalS] o \[ScriptCapitalF] o \
\[ScriptCapitalT]\>\""}], " ", "**)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FT", "=", 
     RowBox[{"PolynomialMod", "[", 
      RowBox[{
       RowBox[{"F", "/.", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           SubscriptBox["x", "i"], " ", "\[Rule]", " ", 
           RowBox[{"T", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}], ",", " ", "mod"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"P", "=", 
     RowBox[{
      RowBox[{"PolynomialMod", "[", 
       RowBox[{
        RowBox[{"S", "/.", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            SubscriptBox["x", "i"], " ", "\[Rule]", " ", 
            RowBox[{"FT", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "m"}], "}"}]}], "]"}]}], ",", " ", "mod"}], 
       "]"}], "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";"}]}]}]], "Input",
 CellLabel->
  "In[654]:=",ExpressionUUID->"8cad7070-7ee2-4cf9-87e4-a9e01d806d6f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"*", " ", "Generate", " ", "hash", " ", "\"\<w\>\""}], " ", 
   "**)"}], "\[IndentingNewLine]", 
  RowBox[{"w", "=", 
   RowBox[{"RandomInteger", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"mod", "-", "1"}]}], "}"}], ",", "m"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.798806365095504*^9, 3.798806371145395*^9}},
 CellLabel->
  "In[656]:=",ExpressionUUID->"2f704235-7c41-4d86-9f8d-452d63900d12"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "Compute", " ", 
    "\"\<x = \!\(\*SuperscriptBox[\(\[ScriptCapitalS]\), \(-1\)]\)(w)\>\""}], 
   " ", "**)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"xx", " ", "=", " ", 
    RowBox[{"Mod", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["A2", 
        RowBox[{"-", "1"}]], ".", 
       RowBox[{"(", 
        RowBox[{"w", "-", "b2"}], ")"}]}], ",", "mod"}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{
  3.797250685420253*^9, {3.79725466687665*^9, 3.7972546857796893`*^9}, 
   3.797255308544813*^9, 3.797255360699927*^9, {3.797255856613022*^9, 
   3.79725585691218*^9}, 3.797255922730638*^9, 3.7972566950998735`*^9, {
   3.797256769107726*^9, 3.7972567693859825`*^9}, 3.797258021035828*^9, 
   3.7972601062329545`*^9, 3.797262070190896*^9, {3.797434409062111*^9, 
   3.7974344094351215`*^9}, {3.7975028060281057`*^9, 
   3.7975028070485473`*^9}, {3.7988063693017993`*^9, 3.798806373064411*^9}, {
   3.798806587157581*^9, 3.7988065917168093`*^9}},
 CellLabel->
  "In[657]:=",ExpressionUUID->"ea5b5dc6-83c9-44b3-a7a0-c1a1a8ac0583"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"*", " ", "Compute", " ", "pre"}], "-", 
    RowBox[{"image", " ", "\"\<y\>\"", " ", "of", " ", "\"\<x\>\""}]}], " ", 
   "**)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Label", "[", "preImage", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"knownVar", "=", "vinVars"}], ";", "\[IndentingNewLine]", 
     RowBox[{"y", "=", 
      RowBox[{"RandomInteger", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", 
          RowBox[{"mod", "-", "1"}]}], "}"}], ",", "knownVar"}], "]"}]}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", "u"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"FF", " ", "=", " ", 
         RowBox[{
          RowBox[{"F", " ", "/.", " ", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              SubscriptBox["x", "i"], " ", "\[Rule]", " ", 
              RowBox[{"y", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", " ", "knownVar"}], "}"}]}], "]"}]}], "//", 
          " ", 
          RowBox[{
           RowBox[{"Expand", "[", 
            RowBox[{"#", ",", 
             RowBox[{"Modulus", "\[Rule]", "mod"}]}], "]"}], "&"}]}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"solveList", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"FF", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", 
            RowBox[{"xx", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"knownVar", "+", "1", "-", "vinVars"}], ",", " ", 
             RowBox[{"knownVar", "+", 
              RowBox[{"oilVars", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "-", "vinVars"}]}], "}"}]}], 
          "]"}]}], " ", ";", "\[IndentingNewLine]", "\t", 
        RowBox[{"res", " ", "=", " ", 
         RowBox[{"Solve", "[", 
          RowBox[{"solveList", ",", " ", 
           RowBox[{"Modulus", "\[Rule]", "mod"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"If", " ", "solution", " ", "not", " ", "possible"}], " ", 
          "\[Rule]", " ", 
          RowBox[{
          "Select", " ", "different", " ", "values", " ", "for", " ", 
           "\"\<y\>\""}]}], " ", "*)"}], "\[IndentingNewLine]", "\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "res", "]"}], "\[Equal]", "0"}], ",", " ", 
          RowBox[{"Goto", "[", "preImage", "]"}], ","}], "]"}], ";", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"y", "=", " ", 
         RowBox[{"Join", "[", 
          RowBox[{"y", ",", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              SubscriptBox["x", "i"], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", 
                RowBox[{"knownVar", "+", "1"}], ",", 
                RowBox[{"knownVar", "+", 
                 RowBox[{"oilVars", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}]}], "]"}], " ", "/.",
             " ", 
            RowBox[{"res", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"knownVar", "=", 
         RowBox[{"knownVar", "+", 
          RowBox[{"oilVars", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        "\t", 
        RowBox[{"(*", " ", 
         RowBox[{
         "\"\<solveList\>\"", " ", "contains", " ", "linear", " ", 
          "equations", " ", "and", " ", "the", " ", "Gaussian", " ", 
          "elimination", " ", "can", " ", "be", " ", "used"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"Print", "[", "solveList", "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], ")"}], "\[IndentingNewLine]", 
   "y"}]}]], "Input",
 CellChangeTimes->{{3.7972550441779385`*^9, 3.797255051021189*^9}, {
   3.7972551723304634`*^9, 3.7972551945268755`*^9}, {3.797255397312787*^9, 
   3.797255403096487*^9}, {3.7972555038911967`*^9, 3.797255511272353*^9}, 
   3.7972555446493063`*^9, 3.7972556693576517`*^9, {3.7972557559429846`*^9, 
   3.7972557689705086`*^9}, {3.7972558800320835`*^9, 3.797255914484203*^9}, {
   3.7972560709463434`*^9, 3.7972560885683374`*^9}, {3.7972561314266415`*^9, 
   3.7972561338634577`*^9}, {3.7972561706760254`*^9, 3.7972561803262343`*^9}, 
   3.797256216372585*^9, {3.797256253034017*^9, 3.7972562534548855`*^9}, {
   3.7972562897917724`*^9, 3.797256342820097*^9}, {3.797256384976569*^9, 
   3.7972564270078487`*^9}, {3.797256550444919*^9, 3.797256569767292*^9}, 
   3.7972567052968435`*^9, {3.797256777099203*^9, 3.7972568152723894`*^9}, {
   3.7972568749072065`*^9, 3.797256875171764*^9}, {3.797256914343642*^9, 
   3.79725692852302*^9}, {3.7972569673229704`*^9, 3.79725702290405*^9}, {
   3.797257119325934*^9, 3.7972571241366453`*^9}, {3.7972571573956137`*^9, 
   3.7972571631203203`*^9}, {3.797257244767453*^9, 3.7972572464930687`*^9}, {
   3.797257502721778*^9, 3.7972575431865807`*^9}, {3.7972576814809837`*^9, 
   3.797257684255401*^9}, {3.797257841610175*^9, 3.797257841744337*^9}, {
   3.7972579624494357`*^9, 3.797257971702038*^9}, {3.7972582400911436`*^9, 
   3.797258276069796*^9}, {3.797258312714185*^9, 3.7972583461493883`*^9}, {
   3.797258406299533*^9, 3.7972584066526003`*^9}, {3.79725846253098*^9, 
   3.797258491236577*^9}, {3.7972585297266626`*^9, 3.797258597051649*^9}, {
   3.7972586295437717`*^9, 3.7972586412634354`*^9}, {3.7972589700620117`*^9, 
   3.7972589907971315`*^9}, {3.79725905680801*^9, 3.7972590791658316`*^9}, {
   3.7972591169701114`*^9, 3.7972591407065845`*^9}, 3.797259399168206*^9, {
   3.7972594769665604`*^9, 3.797259524369579*^9}, {3.7972597328341446`*^9, 
   3.7972597591395235`*^9}, 3.797259850701189*^9, {3.7972599985427895`*^9, 
   3.797260004055691*^9}, {3.7972602112936735`*^9, 3.797260215058078*^9}, {
   3.7972604073181396`*^9, 3.797260407668208*^9}, 3.79726052255476*^9, {
   3.7972607442211113`*^9, 3.797260759407425*^9}, {3.797260819803626*^9, 
   3.797260849289689*^9}, {3.7972608831809983`*^9, 3.7972608852362785`*^9}, {
   3.797260921858893*^9, 3.7972609221481476`*^9}, {3.797260963637765*^9, 
   3.797261000550458*^9}, {3.797261134046275*^9, 3.797261147756916*^9}, {
   3.7972612629683094`*^9, 3.7972612851840057`*^9}, {3.797262002339384*^9, 
   3.7972620067156205`*^9}, {3.7975028234832354`*^9, 
   3.7975028250062585`*^9}, {3.7978561995978656`*^9, 
   3.7978562088966365`*^9}, {3.798205002489358*^9, 3.798205036305027*^9}, {
   3.798205236112378*^9, 3.7982052463320246`*^9}, {3.798205299433176*^9, 
   3.7982053207562065`*^9}, {3.7982053774945197`*^9, 3.798205408539566*^9}, {
   3.7982054633270636`*^9, 3.7982054685241776`*^9}, {3.7982055863123198`*^9, 
   3.79820558665838*^9}, {3.7983530949340997`*^9, 3.7983530961248627`*^9}, {
   3.7983531610052834`*^9, 3.798353203004342*^9}, {3.798353255809188*^9, 
   3.798353256004218*^9}, {3.7988075059597015`*^9, 3.798807513203187*^9}, {
   3.7988075720537767`*^9, 3.7988076764104223`*^9}},
 CellLabel->
  "In[658]:=",ExpressionUUID->"1b27c45a-ba47-40a2-9797-b5ac72609f5c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "Compute", " ", "signature", " ", 
    "\"\<z = \!\(\*SuperscriptBox[\(\[ScriptCapitalT]\), \(-1\)]\)(y)\>\""}], 
   " ", "**)"}], "\[IndentingNewLine]", 
  RowBox[{"z", " ", "=", " ", 
   RowBox[{"Mod", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["A", 
       RowBox[{"-", "1"}]], ".", 
      RowBox[{"(", 
       RowBox[{"y", "-", "b"}], ")"}]}], ",", "mod"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7972621600718327`*^9, 3.797262160431796*^9}, {
   3.7972622683669767`*^9, 3.797262341778688*^9}, {3.7972627841911697`*^9, 
   3.7972627845103235`*^9}, {3.7975028304231997`*^9, 3.7975028312918053`*^9}, 
   3.7976671809881496`*^9},
 CellLabel->
  "In[660]:=",ExpressionUUID->"d0e99f59-cce1-488d-9e43-20e5c59643b1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"*", " ", "Test", " ", "of", " ", 
    RowBox[{"correctness", "/", "Verification"}], " ", "of", " ", 
    "signature"}], " ", "**)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"w2", "=", 
     RowBox[{"P", "/.", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         SubscriptBox["x", "i"], " ", "\[Rule]", " ", 
         RowBox[{"z", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "n"}], "}"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"True", "?"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Mod", "[", 
     RowBox[{"w2", ",", "mod"}], "]"}], "\[Equal]", "w", " "}]}]}]], "Input",
 CellChangeTimes->{{3.7972627506842146`*^9, 3.797262769841457*^9}, 
   3.7972628189895687`*^9, 3.797262889704994*^9, {3.798205640185274*^9, 
   3.798205678631474*^9}, {3.7988060783938284`*^9, 3.798806078794922*^9}, 
   3.7988069670246525`*^9},
 CellLabel->
  "In[661]:=",ExpressionUUID->"1e4571c2-2c80-4dfa-b6ae-d966be295f37"]
},
WindowSize->{1014, 782},
WindowMargins->{{-7, Automatic}, {Automatic, 0}},
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 13462, 261, 526, "Text",ExpressionUUID->"e01c60df-0cde-4d23-b2c1-173ccb3d81be"],
Cell[14023, 283, 11891, 283, 808, "Input",ExpressionUUID->"a2ffbd8b-bea5-4d77-b279-6ea5a3abb6df"],
Cell[25917, 568, 1392, 41, 67, "Input",ExpressionUUID->"8cad7070-7ee2-4cf9-87e4-a9e01d806d6f"],
Cell[27312, 611, 485, 13, 48, "Input",ExpressionUUID->"2f704235-7c41-4d86-9f8d-452d63900d12"],
Cell[27800, 626, 1120, 27, 48, "Input",ExpressionUUID->"ea5b5dc6-83c9-44b3-a7a0-c1a1a8ac0583"],
Cell[28923, 655, 7532, 151, 333, "Input",ExpressionUUID->"1b27c45a-ba47-40a2-9797-b5ac72609f5c"],
Cell[36458, 808, 792, 20, 48, "Input",ExpressionUUID->"d0e99f59-cce1-488d-9e43-20e5c59643b1"],
Cell[37253, 830, 1149, 30, 86, "Input",ExpressionUUID->"1e4571c2-2c80-4dfa-b6ae-d966be295f37"]
}
]
*)

