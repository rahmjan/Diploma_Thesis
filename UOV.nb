(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     26138,        682]
NotebookOptionsPosition[     24448,        647]
NotebookOutlinePosition[     24899,        664]
CellTagsIndexPosition[     24856,        661]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "Combinatorica`"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", " ", "F"}], "=", 
    RowBox[{
     RowBox[{"GF", 
      RowBox[{"(", "7", ")"}], " ", "and", " ", "o"}], "=", 
     RowBox[{"v", "=", "3"}]}]}], "  ", "***)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mod", "=", "7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"F1", "[", 
    RowBox[{
    "x1_", ",", "x2_", ",", "x3_", ",", "x4_", ",", "x5_", ",", "x6_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"4", 
     RowBox[{"x1", "^", "2"}]}], "+", 
    RowBox[{"4", "x1", "*", "x3"}], "+", 
    RowBox[{"5", "x1", "*", "x4"}], "+", 
    RowBox[{"6", "x1", "*", "x5"}], "+", 
    RowBox[{"x1", "*", "x6"}], "+", 
    RowBox[{"6", "x1"}], "+", 
    RowBox[{"4", 
     RowBox[{"x2", "^", "2"}]}], "+", 
    RowBox[{"x2", "*", "x3"}], "+", 
    RowBox[{"6", "x2", "*", "x4"}], "+", 
    RowBox[{"6", "x2", "*", "x5"}], "+", 
    RowBox[{"5", "x2", "*", "x6"}], "+", 
    RowBox[{"5", "x2"}], "+", 
    RowBox[{"5", 
     RowBox[{"x3", "^", "2"}]}], "+", 
    RowBox[{"3", "x3", "*", "x4"}], "+", 
    RowBox[{"5", "x3", "*", "x5"}], "+", 
    RowBox[{"2", "x3", "*", "x6"}], "+", 
    RowBox[{"5", "x3"}], "+", 
    RowBox[{"6", "x4"}], "+", 
    RowBox[{"3", "x5"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"F2", "[", 
    RowBox[{
    "x1_", ",", "x2_", ",", "x3_", ",", "x4_", ",", "x5_", ",", "x6_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"3", "x1", "*", "x3"}], "+", 
    RowBox[{"4", "x1", "*", "x4"}], "+", 
    RowBox[{"3", "x1", "*", "x5"}], "+", 
    RowBox[{"4", "x1", "*", "x6"}], "+", 
    RowBox[{"3", "x1"}], "+", 
    RowBox[{"6", 
     RowBox[{"x2", "^", "2"}]}], "+", 
    RowBox[{"x2", "*", "x3"}], "+", 
    RowBox[{"4", "x2", "*", "x4"}], "+", 
    RowBox[{"4", "x2", "*", "x5"}], "+", 
    RowBox[{"5", "x2", "*", "x6"}], "+", 
    RowBox[{"6", "x2"}], "+", 
    RowBox[{"6", 
     RowBox[{"x3", "^", "2"}]}], "+", 
    RowBox[{"4", "x3", "*", "x4"}], "+", 
    RowBox[{"2", "x3", "*", "x5"}], "+", 
    RowBox[{"x3", "*", "x6"}], "+", 
    RowBox[{"3", "x3"}], "+", "x4", "+", "x6", "+", "1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"F3", "[", 
    RowBox[{
    "x1_", ",", "x2_", ",", "x3_", ",", "x4_", ",", "x5_", ",", "x6_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"6", 
     RowBox[{"x1", "^", "2"}]}], "+", 
    RowBox[{"6", "x1", "*", "x3"}], "+", 
    RowBox[{"4", "x1", "*", "x5"}], "+", 
    RowBox[{"2", "x1", "*", "x6"}], "+", 
    RowBox[{"2", 
     RowBox[{"x2", "^", "2"}]}], "+", 
    RowBox[{"5", "x2", "*", "x3"}], "+", 
    RowBox[{"6", "x2", "*", "x4"}], "+", 
    RowBox[{"5", "x2", "*", "x5"}], "+", 
    RowBox[{"5", "x2", "*", "x6"}], "+", 
    RowBox[{"6", "x2"}], "+", 
    RowBox[{"3", 
     RowBox[{"x3", "^", "2"}]}], "+", 
    RowBox[{"5", "x3", "*", "x4"}], "+", 
    RowBox[{"6", "x3", "*", "x5"}], "+", 
    RowBox[{"x3", "*", "x6"}], "+", 
    RowBox[{"3", "x3"}], "+", 
    RowBox[{"4", "x4"}], "+", 
    RowBox[{"6", "x5"}], "+", "5"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"(", GridBox[{
      {"6", "5", "5", "5", "5", "4"},
      {"6", "6", "4", "5", "0", "6"},
      {"2", "5", "2", "1", "5", "0"},
      {"1", "1", "6", "2", "2", "3"},
      {"3", "6", "2", "2", "3", "0"},
      {"0", "5", "4", "6", "1", "5"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"b", "=", 
   RowBox[{"(", GridBox[{
      {"1"},
      {"2"},
      {"4"},
      {"1"},
      {"3"},
      {"2"}
     }], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"T", "=", 
    RowBox[{
     RowBox[{"A", ".", 
      RowBox[{"(", GridBox[{
         {"x1"},
         {"x2"},
         {"x3"},
         {"x4"},
         {"x5"},
         {"x6"}
        }], ")"}]}], "+", "b"}]}], ";"}], " "}]}], "Input",
 CellChangeTimes->{{3.7889684666384945`*^9, 3.788968663137044*^9}, {
   3.7889687037264986`*^9, 3.788968762995002*^9}, {3.7889692466815233`*^9, 
   3.788969253813451*^9}, {3.7889719196726265`*^9, 3.788971931335428*^9}, {
   3.788971974498002*^9, 3.788971980003391*^9}, {3.78897207364985*^9, 
   3.7889720738742933`*^9}, {3.7889721712697935`*^9, 
   3.7889721773644953`*^9}, {3.789480591442012*^9, 3.7894806395493464`*^9}, {
   3.789480685149413*^9, 3.7894807438364673`*^9}, {3.789480838741209*^9, 
   3.7894808633025274`*^9}, {3.7894809650913324`*^9, 
   3.7894809657066803`*^9}, {3.789481087071131*^9, 3.7894810877762384`*^9}, {
   3.789481486530736*^9, 3.789481489029055*^9}, {3.789808592448105*^9, 
   3.7898085925948524`*^9}, {3.7898086335737257`*^9, 3.78980865671242*^9}, {
   3.7898087512805953`*^9, 3.789808751771305*^9}, {3.7898089664703465`*^9, 
   3.789809159381069*^9}, {3.7898092467140036`*^9, 3.789809330158414*^9}, {
   3.7898093657129564`*^9, 3.789809478538104*^9}, {3.7898105804606676`*^9, 
   3.7898105837877626`*^9}, {3.7898107259558496`*^9, 3.789810727209897*^9}, {
   3.7898131332938433`*^9, 3.7898131747383623`*^9}, {3.7898132153005943`*^9, 
   3.789813222020677*^9}, {3.789813331053226*^9, 3.789813343032039*^9}, {
   3.789815839106205*^9, 3.7898158396467485`*^9}, 3.7898158899552126`*^9, {
   3.7898160318058753`*^9, 3.789816032051228*^9}, {3.7898166278070593`*^9, 
   3.78981663869296*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"0ee780ac-9fd0-4ee1-90bf-764db02ace47"],

Cell[BoxData[
 TemplateBox[{
  "General","compat",
   "\"Combinatorica Graph and Permutations functionality has been superseded \
by preloaded functionality. The package now being loaded may conflict with \
this. Please see the Compatibility Guide for details.\"",2,2,1,
   30334526368117787575,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.7898158405922194`*^9, 3.789815874016862*^9, 
  3.7898186931619816`*^9, 3.7898194024671516`*^9, 3.7898211176833067`*^9, 
  3.7898212700885344`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"1d376911-c4a2-4216-9313-8663299b9ca4"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "Compute", " ", "public", " ", "key", " ", "\"\<P = F o T\>\""}],
    " ", "**)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"p1", " ", "=", " ", 
     RowBox[{"F1", "[", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
       RowBox[{"T", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
       RowBox[{"T", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
       RowBox[{"T", "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", " ", 
       RowBox[{"T", "[", 
        RowBox[{"[", "5", "]"}], "]"}], ",", " ", 
       RowBox[{"T", "[", 
        RowBox[{"[", "6", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p2", " ", "=", " ", 
     RowBox[{"F2", "[", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
       RowBox[{"T", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
       RowBox[{"T", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
       RowBox[{"T", "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", " ", 
       RowBox[{"T", "[", 
        RowBox[{"[", "5", "]"}], "]"}], ",", " ", 
       RowBox[{"T", "[", 
        RowBox[{"[", "6", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p3", " ", "=", " ", 
     RowBox[{"F3", "[", 
      RowBox[{
       RowBox[{"T", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
       RowBox[{"T", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
       RowBox[{"T", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", " ", 
       RowBox[{"T", "[", 
        RowBox[{"[", "4", "]"}], "]"}], ",", " ", 
       RowBox[{"T", "[", 
        RowBox[{"[", "5", "]"}], "]"}], ",", " ", 
       RowBox[{"T", "[", 
        RowBox[{"[", "6", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P1", "[", 
      RowBox[{
      "x1_", ",", "x2_", ",", "x3_", ",", "x4_", ",", "x5_", ",", "x6_"}], 
      "]"}], " ", "=", " ", 
     RowBox[{"PolynomialMod", "[", 
      RowBox[{
       RowBox[{"Simplify", "[", "p1", "]"}], ",", "mod"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P2", "[", 
      RowBox[{
      "x1_", ",", "x2_", ",", "x3_", ",", "x4_", ",", "x5_", ",", "x6_"}], 
      "]"}], " ", "=", " ", 
     RowBox[{"PolynomialMod", "[", 
      RowBox[{
       RowBox[{"Simplify", "[", "p2", "]"}], ",", "mod"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"P3", "[", 
      RowBox[{
      "x1_", ",", "x2_", ",", "x3_", ",", "x4_", ",", "x5_", ",", "x6_"}], 
      "]"}], " ", "=", " ", 
     RowBox[{"PolynomialMod", "[", 
      RowBox[{
       RowBox[{"Simplify", "[", "p3", "]"}], ",", "mod"}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7898095371371655`*^9, 3.7898095900508113`*^9}, {
  3.7898096802557325`*^9, 3.7898097421421075`*^9}, {3.789809833293831*^9, 
  3.789809834836192*^9}, {3.7898100199002376`*^9, 3.789810168604097*^9}, {
  3.789810262009087*^9, 3.7898102850643024`*^9}, {3.789810719922843*^9, 
  3.789810721514736*^9}, {3.7898111183738403`*^9, 3.7898111436371927`*^9}, {
  3.7898185809141555`*^9, 3.7898186305045395`*^9}, {3.789818830771984*^9, 
  3.789818851154477*^9}, {3.7898189423336444`*^9, 3.789818952846531*^9}, {
  3.7898190040236993`*^9, 3.78981901149472*^9}, {3.789819067072068*^9, 
  3.7898191178074107`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"10118d26-a960-49e4-8f22-72009ab4ab9f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "*", " ", "Compute", " ", "signature", " ", "\"\<z\>\"", " ", "for", " ", 
    "\"\<w\>\""}], " ", "**)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"w", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "3", "}"}], ",", 
       RowBox[{"{", "6", "}"}], ",", 
       RowBox[{"{", "4", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x1", "=", " ", "1"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Values", " ", "for", " ", "\"\<x\>\"", "s", " ", "are", " ", "randomly", 
     " ", "selected"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x2", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x3", "=", " ", "6"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7889687820181227`*^9, 3.788968827293056*^9}, {
   3.7889691114581127`*^9, 3.78896913441076*^9}, {3.7894806258709326`*^9, 
   3.7894806263476562`*^9}, 3.7894806833781195`*^9, {3.7894808365789967`*^9, 
   3.7894808372092977`*^9}, {3.789808780222294*^9, 3.789808819719979*^9}, {
   3.789810319168583*^9, 3.7898103543858976`*^9}, {3.7898104305440364`*^9, 
   3.7898104390397425`*^9}, 3.789810473793621*^9, {3.789810722903133*^9, 
   3.789810723808831*^9}, 3.789818392061214*^9, {3.789821105860922*^9, 
   3.7898211124991693`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"0edc01f2-6d7b-419e-abbd-217adbee93d3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f1", " ", "=", " ", 
   RowBox[{"PolynomialMod", "[", 
    RowBox[{
     RowBox[{"F1", "[", 
      RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", "x6"}], 
      "]"}], ",", "mod"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f2", " ", "=", " ", 
   RowBox[{"PolynomialMod", "[", 
    RowBox[{
     RowBox[{"F2", "[", 
      RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", "x6"}], 
      "]"}], ",", "mod"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f3", " ", "=", " ", 
   RowBox[{"PolynomialMod", "[", 
    RowBox[{
     RowBox[{"F3", "[", 
      RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4", ",", "x5", ",", "x6"}], 
      "]"}], ",", "mod"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7889688475827694`*^9, 3.7889688573556614`*^9}, {
  3.7889691510661926`*^9, 3.788969158571123*^9}, {3.788969230225503*^9, 
  3.788969275104519*^9}, {3.788969428771577*^9, 3.7889694688494*^9}, {
  3.7889698458163133`*^9, 3.788969847328262*^9}, {3.789480643786023*^9, 
  3.789480653107071*^9}, {3.789480807732135*^9, 3.789480835018158*^9}, {
  3.789810383049344*^9, 3.7898104076468153`*^9}, {3.7898104475128584`*^9, 
  3.7898104479421887`*^9}, {3.789810641848915*^9, 3.789810669085778*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"566941a4-609c-4298-9808-0c10ddc5c39c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Solve", " ", "//", 
    RowBox[{
    "We", " ", "can", " ", "also", " ", "use", " ", "Gaussian", " ", 
     "Elimination"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"res", " ", "=", " ", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"f1", "\[Equal]", 
          RowBox[{"w", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
         RowBox[{"f2", "\[Equal]", 
          RowBox[{"w", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
         RowBox[{"f3", "\[Equal]", 
          RowBox[{"w", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}], ",", 
       RowBox[{"Modulus", " ", "\[Rule]", " ", "mod"}]}], "]"}]}], ";"}], " ",
    "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"If", " ", "solution", " ", "not", " ", "possible"}], " ", 
     "\[Rule]", " ", 
     RowBox[{
     "Select", " ", "different", " ", "values", " ", "for", " ", "\"\<x\>\"", 
      "s"}]}], " ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.788969347800085*^9, 3.788969403298706*^9}, {
   3.788969497027048*^9, 3.7889695460160418`*^9}, {3.7889695933594427`*^9, 
   3.7889696433048444`*^9}, {3.788969709321328*^9, 3.788969788765877*^9}, {
   3.788969827559144*^9, 3.788969871302131*^9}, {3.788971575009346*^9, 
   3.788971646001497*^9}, {3.788971935513282*^9, 3.788971951888465*^9}, {
   3.7889719939140797`*^9, 3.7889719961710434`*^9}, 3.7889720698101177`*^9, {
   3.7889721432896194`*^9, 3.7889721467094736`*^9}, {3.7894806565568714`*^9, 
   3.789480661837741*^9}, {3.7894808162363663`*^9, 3.789480822925504*^9}, {
   3.78981068730698*^9, 3.7898106922015133`*^9}, {3.789810790711569*^9, 
   3.789810799262418*^9}, {3.789817774382989*^9, 3.7898178485217533`*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"7ec67c11-6230-4634-a2f8-84ca6b3153e6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Pre", "-", "image"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"x", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "x1", ",", "x2", ",", " ", "x3", ",", " ", "x4", ",", "x5", ",", "x6"}], 
     "}"}], " ", "/.", " ", "res", " ", 
    RowBox[{"(*", " ", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "6", ",", "6", ",", "3", ",", "0"}], "}"}],
       "}"}], " ", "*)"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7889721540887775`*^9, 3.788972159780518*^9}, {
  3.7889722203565254`*^9, 3.7889722349185867`*^9}, {3.788972278855115*^9, 
  3.788972320468804*^9}, {3.7889724296049995`*^9, 3.7889724324503736`*^9}, {
  3.7889724960433197`*^9, 3.7889725127596073`*^9}, {3.7894806311029406`*^9, 
  3.7894806315587215`*^9}, {3.7894806661392198`*^9, 3.7894806751381874`*^9}, {
  3.7894808250598073`*^9, 3.7894808279700146`*^9}, {3.78981069708341*^9, 
  3.7898107007161865`*^9}, {3.7898213896308823`*^9, 
  3.789821394402094*^9}},ExpressionUUID->"de483af8-16de-4351-bfdf-\
0b81fcc3f2a1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"1", ",", "0", ",", "6", ",", "6", ",", "3", ",", "0"}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.789813382939703*^9, 3.7898158742841206`*^9, 
  3.7898186934452696`*^9, 3.7898194037756524`*^9, 3.789821117992514*^9, 
  3.789821270763727*^9},
 CellLabel->"Out[24]=",ExpressionUUID->"c61d9032-5532-4808-88e9-090cb4bbc08a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Inversion", " ", "of", " ", "matrix", " ", "\"\<A\>\"", " ", "modulo", 
    " ", "\"\<m\>\""}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"cofA", " ", "=", " ", "A"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"invDet", " ", "=", " ", 
     RowBox[{"ModularInverse", "[", 
      RowBox[{
       RowBox[{"Det", "[", "A", "]"}], ",", "mod"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n", "=", "6"}], ";"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"Size", " ", "of", " ", "matrix"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "<=", "n"}], ",", " ", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "<=", "n"}], ",", " ", 
       RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"cofA", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "=", " ", 
         RowBox[{"Cofactor", "[", 
          RowBox[{"A", ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "i"}], "}"}]}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["A", 
      RowBox[{"-", "1"}]], "=", 
     RowBox[{"Mod", "[", 
      RowBox[{
       RowBox[{"cofA", "*", "invDet"}], ",", "mod"}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7898135534611464`*^9, 3.789813651608926*^9}, {
   3.7898139198117056`*^9, 3.7898139252141776`*^9}, {3.789814007470362*^9, 
   3.7898140148081975`*^9}, {3.789814209693819*^9, 3.789814269730375*^9}, {
   3.789814319975521*^9, 3.7898143438568482`*^9}, {3.789817276963192*^9, 
   3.789817357547719*^9}, {3.789817399846602*^9, 3.789817466352765*^9}, {
   3.789817636269332*^9, 3.789817646125004*^9}, 3.7898176848235164`*^9, {
   3.7898180141498327`*^9, 3.789818026802991*^9}, {3.789818291857155*^9, 
   3.7898183018863616`*^9}},
 CellLabel->"In[25]:=",ExpressionUUID->"2f6da0a6-8a54-496a-9a4b-b2cb97a0b62c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Compute", " ", "\"\<z\>\""}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"z", " ", "=", " ", 
   RowBox[{"Mod", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["A", 
       RowBox[{"-", "1"}]], ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Transpose", "[", "x", "]"}], "-", "b"}], ")"}]}], ",", 
     "mod"}], "]"}], " ", 
   RowBox[{"(*", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "4", "}"}], ",", 
      RowBox[{"{", "1", "}"}], ",", 
      RowBox[{"{", "5", "}"}], ",", 
      RowBox[{"{", "6", "}"}], ",", 
      RowBox[{"{", "3", "}"}], ",", 
      RowBox[{"{", "5", "}"}]}], "}"}], " ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.7898176684572544`*^9, 3.7898176797071714`*^9}, 
   3.789817903992385*^9, {3.789818172311844*^9, 3.7898182792269306`*^9}, {
   3.78981832615546*^9, 3.7898183411004677`*^9}, {3.789821403577598*^9, 
   3.7898214092583647`*^9}},ExpressionUUID->"6a6b4494-8818-4977-adab-\
f507afbe6d3a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "4", "}"}], ",", 
   RowBox[{"{", "1", "}"}], ",", 
   RowBox[{"{", "5", "}"}], ",", 
   RowBox[{"{", "6", "}"}], ",", 
   RowBox[{"{", "3", "}"}], ",", 
   RowBox[{"{", "5", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7898182233045063`*^9, 3.7898183433973246`*^9}, 
   3.789818693501113*^9, 3.789819403851491*^9, 3.789821118048376*^9, 
   3.789821270812598*^9},
 CellLabel->"Out[30]=",ExpressionUUID->"31aa0bf4-2480-4f19-8a79-046b7743b519"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"*", " ", "Test", " ", "of", " ", "correctness"}], " ", "**)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"w2", "=", "w"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"w2", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"P1", "[", 
        RowBox[{
         RowBox[{"z", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
         RowBox[{"z", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", " ", 
         RowBox[{"z", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}], ",", " ", 
         RowBox[{"z", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "1"}], "]"}], "]"}], ",", " ", 
         RowBox[{"z", "[", 
          RowBox[{"[", 
           RowBox[{"5", ",", "1"}], "]"}], "]"}], ",", " ", 
         RowBox[{"z", "[", 
          RowBox[{"[", 
           RowBox[{"6", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "        ", 
       RowBox[{"P2", "[", 
        RowBox[{
         RowBox[{"z", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
         RowBox[{"z", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
         RowBox[{"z", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}], ",", " ", 
         RowBox[{"z", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "1"}], "]"}], "]"}], ",", " ", 
         RowBox[{"z", "[", 
          RowBox[{"[", 
           RowBox[{"5", ",", "1"}], "]"}], "]"}], ",", " ", 
         RowBox[{"z", "[", 
          RowBox[{"[", 
           RowBox[{"6", ",", "1"}], "]"}], "]"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "        ", 
       RowBox[{"P3", "[", 
        RowBox[{
         RowBox[{"z", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", " ", 
         RowBox[{"z", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", " ", 
         RowBox[{"z", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}], ",", " ", 
         RowBox[{"z", "[", 
          RowBox[{"[", 
           RowBox[{"4", ",", "1"}], "]"}], "]"}], ",", " ", 
         RowBox[{"z", "[", 
          RowBox[{"[", 
           RowBox[{"5", ",", "1"}], "]"}], "]"}], ",", " ", 
         RowBox[{"z", "[", 
          RowBox[{"[", 
           RowBox[{"6", ",", "1"}], "]"}], "]"}]}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"True", "?"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Thread", "[", 
    RowBox[{
     RowBox[{"Mod", "[", 
      RowBox[{"w2", ",", "mod"}], "]"}], "\[Equal]", "w"}], " ", 
    "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdyj1IAgEABeArLgiJchDzGgIHQ4JoEwMhlKNBE8oaIjFEs8wgodCEsiiw
RAvKFgWpXBpEwiihGjKkHwiHCiEKq9OyIwicQjGKfDc8Ph7viU12naWWIIiW
aqBX4lIvKb6U35aiBkYSTX2Qmevsh2X21wyFIsYBb8vxBXixP7PI7bw1PzSv
BzkfXZEQ5NdUOAP06y6k6HgMdlkzCZjrfk7CmNZ9CX3XxjScpGx3UP+wcg/f
s+QLLIVJBjqDxTdo+pQVuC4YK8FBD0suV/04NPKgvcPaAI+vPHyYPyAFsD4d
aoPnzjop1M42D0CZ6GYI7rATBtiYbR+Bf6nMKNyIUhYoVcanoFwnnoaKaM7B
/bxiNzwtpFZhJXzkh70qWwC2Ur4tuLk3HoI9P4ZtKPTIz6BaokpCev7kCQ5r
9Az8B4kXz40=
  "],
 CellLabel->"In[39]:=",ExpressionUUID->"66d2a40c-7c8f-4986-83db-494ae817173f"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.7898196368034887`*^9, {3.789819677069815*^9, 3.789819690228659*^9}, {
   3.789819845276987*^9, 3.789819944772955*^9}, {3.7898199889926605`*^9, 
   3.789820003811033*^9}, {3.7898200487129855`*^9, 3.7898200643800597`*^9}, 
   3.789820231970895*^9, {3.78982057022635*^9, 3.7898206156179347`*^9}, {
   3.7898208059629126`*^9, 3.789820907108465*^9}, 3.789820994628381*^9, {
   3.789821077629465*^9, 3.7898210856051326`*^9}, {3.7898211180942073`*^9, 
   3.7898211722304783`*^9}, 3.789821270851493*^9, 3.7898217027944303`*^9},
 CellLabel->"Out[41]=",ExpressionUUID->"e6ebb5a5-5faf-40eb-9ab8-13682769238a"]
}, Open  ]]
},
WindowSize->{1092, 627},
WindowMargins->{{55, Automatic}, {54, Automatic}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
Magnification:>0.9 Inherited,
FrontEndVersion->"12.0 for Microsoft Windows (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 5507, 148, 501, "Input",ExpressionUUID->"0ee780ac-9fd0-4ee1-90bf-764db02ace47"],
Cell[6089, 172, 617, 13, 20, "Message",ExpressionUUID->"1d376911-c4a2-4216-9313-8663299b9ca4"]
}, Open  ]],
Cell[6721, 188, 3596, 97, 135, "Input",ExpressionUUID->"10118d26-a960-49e4-8f22-72009ab4ab9f"],
Cell[10320, 287, 1427, 32, 99, "Input",ExpressionUUID->"0edc01f2-6d7b-419e-abbd-217adbee93d3"],
Cell[11750, 321, 1367, 29, 63, "Input",ExpressionUUID->"566941a4-609c-4298-9808-0c10ddc5c39c"],
Cell[13120, 352, 1924, 42, 63, "Input",ExpressionUUID->"7ec67c11-6230-4634-a2f8-84ca6b3153e6"],
Cell[CellGroupData[{
Cell[15069, 398, 1073, 23, 45, "Input",ExpressionUUID->"de483af8-16de-4351-bfdf-0b81fcc3f2a1"],
Cell[16145, 423, 383, 8, 30, "Output",ExpressionUUID->"c61d9032-5532-4808-88e9-090cb4bbc08a"]
}, Open  ]],
Cell[16543, 434, 2246, 57, 189, "Input",ExpressionUUID->"2f6da0a6-8a54-496a-9a4b-b2cb97a0b62c"],
Cell[CellGroupData[{
Cell[18814, 495, 1012, 27, 45, "Input",ExpressionUUID->"6a6b4494-8818-4977-adab-f507afbe6d3a"],
Cell[19829, 524, 502, 12, 30, "Output",ExpressionUUID->"31aa0bf4-2480-4f19-8a79-046b7743b519"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20368, 541, 3407, 92, 135, "Input",ExpressionUUID->"66d2a40c-7c8f-4986-83db-494ae817173f"],
Cell[23778, 635, 654, 9, 30, "Output",ExpressionUUID->"e6ebb5a5-5faf-40eb-9ab8-13682769238a"]
}, Open  ]]
}
]
*)

